(self.webpackChunk_plone_volto=self.webpackChunk_plone_volto||[]).push([[7572],{"./src/actions/sidebar/sidebar.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{IZ:function(){return resetMetadataFocus},Of:function(){return setSidebarTab},gh:function(){return setMetadataFieldsets}});var _plone_volto_constants_ActionTypes__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/constants/ActionTypes.js");function setMetadataFieldsets(fieldsets){return{type:_plone_volto_constants_ActionTypes__WEBPACK_IMPORTED_MODULE_0__.Uv,fieldsets:fieldsets}}function resetMetadataFocus(){return{type:_plone_volto_constants_ActionTypes__WEBPACK_IMPORTED_MODULE_0__.wZ}}function setSidebarTab(index){return{type:_plone_volto_constants_ActionTypes__WEBPACK_IMPORTED_MODULE_0__.KA,index:index}}},"./src/components/manage/Blocks/Block/BlocksForm.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return Block_BlocksForm}});var esm_extends=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),useIntl=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/useIntl.js"),cloneDeep=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/cloneDeep.js"),cloneDeep_default=__webpack_require__.n(cloneDeep),map=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/map.js"),map_default=__webpack_require__.n(map),defineProperty=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),redux=__webpack_require__("../../../node_modules/.pnpm/redux@4.2.1/node_modules/redux/es/redux.js"),es=__webpack_require__("../../../node_modules/.pnpm/react-redux@8.1.2_@types+react-dom@18.3.6_@types+react@18.3.20__@types+react@18.3.20_react-do_nbjh6ntydbqdrzuehcvsgmxwbi/node_modules/react-redux/es/index.js"),lib=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/index.js"),injectIntl=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/injectIntl.js"),classnames=__webpack_require__("../../../node_modules/.pnpm/classnames@2.2.6/node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),sidebar=__webpack_require__("./src/actions/sidebar/sidebar.js"),form_form=__webpack_require__("./src/actions/form/form.js"),registry=__webpack_require__("./src/registry.js"),ObjectBrowser=__webpack_require__("./src/components/manage/Sidebar/ObjectBrowser.jsx"),DefaultView=__webpack_require__("./src/components/manage/Blocks/Block/DefaultView.jsx"),objectSpread2=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),SidebarPortal=__webpack_require__("./src/components/manage/Sidebar/SidebarPortal.jsx"),Form=__webpack_require__("./src/components/manage/Form/index.tsx"),__jsx=react.createElement;const DefaultBlockEdit=props=>{var _blocksConfig$data$T,_blocksConfig$data$T2;const{blocksConfig:blocksConfig=registry.default.blocks.blocksConfig}=props,{data:data,onChangeBlock:onChangeBlock,block:block,selected:selected,navRoot:navRoot,contentType:contentType}=props,intl=(0,useIntl.c)(),blockSchema=null==blocksConfig||null===(_blocksConfig$data$T=blocksConfig[data["@type"]])||void 0===_blocksConfig$data$T?void 0:_blocksConfig$data$T.blockSchema,schema="function"==typeof blockSchema?blockSchema((0,objectSpread2.c)((0,objectSpread2.c)({},props),{},{intl:intl})):blockSchema,BlockView=(null==blocksConfig||null===(_blocksConfig$data$T2=blocksConfig[data["@type"]])||void 0===_blocksConfig$data$T2?void 0:_blocksConfig$data$T2.view)||DefaultView.c;return __jsx(react.Fragment,null,__jsx(BlockView,props),schema?__jsx(SidebarPortal.c,{selected:selected},__jsx(Form.CQ,{block:block,schema:schema,title:schema.title,onChangeField:(id,value)=>{onChangeBlock(block,(0,objectSpread2.c)((0,objectSpread2.c)({},data),{},{[id]:value}))},formData:data,navRoot:navRoot,contentType:contentType})):"")};var DefaultEdit=DefaultBlockEdit;DefaultBlockEdit.__docgenInfo={description:"",methods:[],displayName:"DefaultBlockEdit"};var Settings_jsx=react.createElement;const Settings=({data:data,block:block,onChangeBlock:onChangeBlock,schema:schema,navRoot:navRoot,contentType:contentType})=>Settings_jsx(Form.CQ,{schema:schema,title:schema.title,onChangeField:(id,value)=>{onChangeBlock(block,(0,objectSpread2.c)((0,objectSpread2.c)({},data),{},{[id]:value}))},onChangeBlock:onChangeBlock,formData:data,applySchemaEnhancers:!1,navRoot:navRoot,contentType:contentType});var Block_Settings=(0,injectIntl.cp)(Settings);Settings.__docgenInfo={description:"",methods:[],displayName:"Settings",props:{data:{description:"",type:{name:"objectOf",value:{name:"any"}},required:!0},block:{description:"",type:{name:"string"},required:!0},onChangeBlock:{description:"",type:{name:"func"},required:!0},schema:{description:"",type:{name:"objectOf",value:{name:"any"}},required:!0}}};var Schema=__webpack_require__("./src/components/manage/Blocks/Block/Schema.jsx"),Edit_jsx=react.createElement;const messages=(0,lib.defineMessages)({unknownBlock:{id:"Unknown Block",defaultMessage:"Unknown Block {block}"}});class Edit extends react.Component{constructor(...args){super(...args),(0,defineProperty.c)(this,"blockNode",react.createRef())}componentDidMount(){var _blocksConfig$type,_blocksConfig$type2;const{type:type}=this.props,{blocksConfig:blocksConfig=registry.default.blocks.blocksConfig}=this.props;!((null==blocksConfig||null===(_blocksConfig$type=blocksConfig[type])||void 0===_blocksConfig$type?void 0:_blocksConfig$type.blockHasOwnFocusManagement)||null)&&this.props.selected&&this.blockNode.current&&this.blockNode.current.focus();const tab=this.props.manage?1:(null==blocksConfig||null===(_blocksConfig$type2=blocksConfig[type])||void 0===_blocksConfig$type2?void 0:_blocksConfig$type2.sidebarTab)||0;this.props.selected&&this.props.editable&&2!==this.props.sidebarTab&&this.props.setSidebarTab(tab)}UNSAFE_componentWillReceiveProps(nextProps){var _blocksConfig$type3;const{blocksConfig:blocksConfig=registry.default.blocks.blocksConfig}=this.props,{selected:selected,type:type}=this.props;if(!((null==blocksConfig||null===(_blocksConfig$type3=blocksConfig[type])||void 0===_blocksConfig$type3?void 0:_blocksConfig$type3.blockHasOwnFocusManagement)||null)&&nextProps.selected&&selected!==nextProps.selected&&this.blockNode.current&&this.blockNode.current.focus(),(!this.props.selected&&nextProps.selected||type!==nextProps.type)&&this.props.editable){var _blocksConfig$nextPro;const tab=this.props.manage?1:(null==blocksConfig||null===(_blocksConfig$nextPro=blocksConfig[nextProps.type])||void 0===_blocksConfig$nextPro?void 0:_blocksConfig$nextPro.sidebarTab)||0;2!==this.props.sidebarTab&&this.props.setSidebarTab(tab)}}render(){var _this$props$data,_blocksConfig$type4,_this$props$data2,_blocksConfig$type6,_blocksConfig$type7;const{blocksConfig:blocksConfig=registry.default.blocks.blocksConfig}=this.props,{editable:editable,type:type}=this.props,disableNewBlocks=null===(_this$props$data=this.props.data)||void 0===_this$props$data?void 0:_this$props$data.disableNewBlocks;let Block=(null==blocksConfig||null===(_blocksConfig$type4=blocksConfig[type])||void 0===_blocksConfig$type4?void 0:_blocksConfig$type4.edit)||DefaultEdit;var _blocksConfig$type5;(null!==(_this$props$data2=this.props.data)&&void 0!==_this$props$data2&&_this$props$data2.readOnly||!editable&&!registry.default.blocks.showEditBlocksInBabelView)&&(Block=(null==blocksConfig||null===(_blocksConfig$type5=blocksConfig[type])||void 0===_blocksConfig$type5?void 0:_blocksConfig$type5.view)||DefaultView.c);const schema=(null==blocksConfig||null===(_blocksConfig$type6=blocksConfig[type])||void 0===_blocksConfig$type6?void 0:_blocksConfig$type6.schema)||Schema.c,blockHasOwnFocusManagement=(null==blocksConfig||null===(_blocksConfig$type7=blocksConfig[type])||void 0===_blocksConfig$type7?void 0:_blocksConfig$type7.blockHasOwnFocusManagement)||null;return Edit_jsx(react.Fragment,null,null!==Block?Edit_jsx("div",{role:"presentation",onMouseEnter:e=>{e.preventDefault(),e.stopPropagation(),this.props.hovered!==this.props.id&&this.props.setUIState({hovered:this.props.id})},onFocus:e=>{},onMouseLeave:e=>{e.preventDefault(),e.stopPropagation(),this.props.setUIState({hovered:null})},onClick:e=>{const isMultipleSelection=e.shiftKey||e.ctrlKey||e.metaKey;!this.props.selected&&this.props.onSelectBlock(this.props.id,!this.props.selected&&isMultipleSelection,e)},onKeyDown:blockHasOwnFocusManagement||disableNewBlocks?null:e=>this.props.handleKeyDown(e,this.props.index,this.props.id,this.blockNode.current),className:classnames_default()("block",type,this.props.data.variation,{selected:this.props.selected||this.props.multiSelected,multiSelected:this.props.multiSelected,hovered:this.props.hovered===this.props.id}),style:{outline:"none"},ref:this.blockNode,tabIndex:blockHasOwnFocusManagement?null:-1},Edit_jsx(Block,(0,esm_extends.c)({},this.props,{blockNode:this.blockNode,data:this.props.data})),this.props.manage&&Edit_jsx(SidebarPortal.c,{selected:this.props.selected,tab:"sidebar-settings"},Edit_jsx(Block_Settings,(0,esm_extends.c)({},this.props,{schema:schema})))):Edit_jsx("div",{role:"presentation",onMouseEnter:e=>{e.preventDefault(),e.stopPropagation(),this.props.setUIState({hovered:this.props.id})},onFocus:e=>{e.preventDefault(),e.stopPropagation(),this.props.setUIState({hovered:this.props.id})},onMouseLeave:e=>{e.preventDefault(),e.stopPropagation(),this.props.setUIState({hovered:null})},onClick:()=>!this.props.selected&&this.props.onSelectBlock(this.props.id),onKeyDown:blockHasOwnFocusManagement||disableNewBlocks?null:e=>this.props.handleKeyDown(e,this.props.index,this.props.id,this.blockNode.current),className:classnames_default()(`block ${type}`,{selected:this.props.selected}),style:{outline:"none"},ref:this.blockNode,tabIndex:-1},this.props.intl.formatMessage(messages.unknownBlock,{block:type})))}}(0,defineProperty.c)(Edit,"defaultProps",{manage:!1,editable:!0});var Block_Edit=(0,redux.compose)(injectIntl.cp,ObjectBrowser.c,(0,es.connect)(((state,props)=>{var _state$form,_state$sidebar;return{hovered:(null===(_state$form=state.form)||void 0===_state$form?void 0:_state$form.ui.hovered)||null,sidebarTab:null===(_state$sidebar=state.sidebar)||void 0===_state$sidebar?void 0:_state$sidebar.tab}}),{setSidebarTab:sidebar.Of,setUIState:form_form.i}))(Edit);Edit.__docgenInfo={description:"Edit block class.\n@class Edit\n@extends Component",methods:[],displayName:"Edit",props:{manage:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},editable:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},type:{description:"",type:{name:"string"},required:!0},data:{description:"",type:{name:"objectOf",value:{name:"any"}},required:!0},properties:{description:"",type:{name:"objectOf",value:{name:"any"}},required:!0},selected:{description:"",type:{name:"bool"},required:!0},multiSelected:{description:"",type:{name:"bool"},required:!1},index:{description:"",type:{name:"number"},required:!0},id:{description:"",type:{name:"string"},required:!0},onMoveBlock:{description:"",type:{name:"func"},required:!0},onDeleteBlock:{description:"",type:{name:"func"},required:!0},pathname:{description:"",type:{name:"string"},required:!0}}};var DragDropList=__webpack_require__("./src/components/manage/DragDropList/DragDropList.jsx"),Blocks=__webpack_require__("./src/helpers/Blocks/Blocks.js"),useDetectClickOutside=__webpack_require__("./src/helpers/Utils/useDetectClickOutside.js");var Icon=__webpack_require__("./src/components/theme/Icon/Icon.jsx"),drag=__webpack_require__("./src/icons/drag.svg"),drag_default=__webpack_require__.n(drag),Button=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Button/Button.js"),includes=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/includes.js"),includes_default=__webpack_require__.n(includes),isBoolean=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isBoolean.js"),isBoolean_default=__webpack_require__.n(isBoolean),BlockChooserButton=__webpack_require__("./src/components/manage/BlockChooser/BlockChooserButton.jsx"),icons_delete=__webpack_require__("./src/icons/delete.svg"),delete_default=__webpack_require__.n(icons_delete),EditBlockWrapper_jsx=react.createElement;const EditBlockWrapper_messages=(0,lib.defineMessages)({delete:{id:"delete",defaultMessage:"delete"}}),EditBlockWrapper=props=>{const{intl:intl,blockProps:blockProps,draginfo:draginfo,children:children}=props,{allowedBlocks:allowedBlocks,showRestricted:showRestricted,block:block,blocksConfig:blocksConfig,selected:selected,type:type,onChangeBlock:onChangeBlock,onDeleteBlock:onDeleteBlock,onInsertBlock:onInsertBlock,onSelectBlock:onSelectBlock,onMutateBlock:onMutateBlock,data:originalData,editable:editable,properties:properties,showBlockChooser:showBlockChooser,navRoot:navRoot,contentType:contentType}=blockProps,data=(0,Blocks.Qd)((0,objectSpread2.c)((0,objectSpread2.c)({data:originalData},blockProps),{},{intl:intl})),visible=selected&&!(data=>!!data.fixed||!registry.default.experimental.addBlockButton.enabled&&!((0,Blocks.GS)(data)&&props.blockProps.editable))(data),required=isBoolean_default()(data.required)?data.required:includes_default()(registry.default.blocks.requiredBlocks,type);let classNames=(0,Blocks.qi)(data.styles);classNames=(0,Blocks.AX)({block:block,content:properties,data:data,classNames:classNames});const style=(0,Blocks.KK)(data),styleMergedWithDragProps=(0,objectSpread2.c)((0,objectSpread2.c)({},draginfo.draggableProps),{},{style:(0,objectSpread2.c)((0,objectSpread2.c)({},style),draginfo.draggableProps.style)});return EditBlockWrapper_jsx("div",(0,esm_extends.c)({ref:draginfo.innerRef},styleMergedWithDragProps,{className:classnames_default()(`block-editor-${data["@type"]}`,classNames,{[data.align]:data.align})}),EditBlockWrapper_jsx("div",{style:{position:"relative"}},EditBlockWrapper_jsx("div",(0,esm_extends.c)({style:{visibility:visible?"visible":"hidden",display:"inline-block"}},draginfo.dragHandleProps,{className:"drag handle wrapper"}),EditBlockWrapper_jsx(Icon.c,{name:drag_default(),size:"18px"})),EditBlockWrapper_jsx("div",{className:`ui drag block inner ${type}`},children,selected&&!required&&editable&&EditBlockWrapper_jsx(Button.c,{type:"button",icon:!0,basic:!0,onClick:()=>onDeleteBlock(block,!0),className:"delete-button","aria-label":intl.formatMessage(EditBlockWrapper_messages.delete)},EditBlockWrapper_jsx(Icon.c,{name:delete_default(),size:"18px"})),registry.default.experimental.addBlockButton.enabled&&showBlockChooser&&EditBlockWrapper_jsx(BlockChooserButton.c,{data:data,block:block,onInsertBlock:(id,value)=>{if((0,Blocks.GS)(data))onSelectBlock(onInsertBlock(id,value));else{const blocksFieldname=(0,Blocks.c$)(properties),newValue=(0,Blocks.YP)({id:id,value:value,blocksConfig:blocksConfig,formData:(0,objectSpread2.c)((0,objectSpread2.c)({},properties),{},{[blocksFieldname]:(0,objectSpread2.c)((0,objectSpread2.c)({},properties[blocksFieldname]),{},{[id]:value||null})}),intl:intl})[blocksFieldname][id];onChangeBlock(id,newValue)}},onMutateBlock:onMutateBlock,allowedBlocks:allowedBlocks,showRestricted:showRestricted,blocksConfig:blocksConfig,size:"24px",properties:properties,navRoot:navRoot,contentType:contentType}))))};var Block_EditBlockWrapper=(0,injectIntl.cp)(EditBlockWrapper);EditBlockWrapper.__docgenInfo={description:"",methods:[],displayName:"EditBlockWrapper"};var react_dom=__webpack_require__("../../../node_modules/.pnpm/react-dom@18.2.0_react@18.2.0/node_modules/react-dom/index.js"),find=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/find.js"),find_default=__webpack_require__.n(find),min=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/min.js"),min_default=__webpack_require__.n(min),isArray=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArray.js"),isArray_default=__webpack_require__.n(isArray);function getProjection(items,activeId,overId,dragOffset,indentationWidth,arrayMove){const overItemIndex=items.findIndex((({id:id})=>id===overId)),activeItemIndex=items.findIndex((({id:id})=>id===activeId)),activeItem=items[activeItemIndex],newItems=arrayMove(items,activeItemIndex,overItemIndex),previousItem=newItems[overItemIndex-1],nextItem=newItems[overItemIndex+1],dragDepth=function getDragDepth(offset,indentationWidth){return Math.round(offset/indentationWidth)}(dragOffset,indentationWidth),projectedDepth=activeItem.depth+dragDepth,maxDepth=function getMaxDepth({previousItem:previousItem}){const blocksLayoutFieldname=(0,Blocks.Ar)((null==previousItem?void 0:previousItem.data)||{});var _previousItem$data,_previousItem$data$bl;return previousItem?isArray_default()(null===(_previousItem$data=previousItem.data)||void 0===_previousItem$data||null===(_previousItem$data$bl=_previousItem$data[blocksLayoutFieldname])||void 0===_previousItem$data$bl?void 0:_previousItem$data$bl.items)?previousItem.depth+1:previousItem.depth:0}({previousItem:previousItem}),minDepth=function getMinDepth({nextItem:nextItem}){if(nextItem)return nextItem.depth;return 0}({nextItem:nextItem});let depth=projectedDepth;return projectedDepth>=maxDepth?depth=maxDepth:projectedDepth<minDepth&&(depth=minDepth),{depth:depth,maxDepth:maxDepth,minDepth:minDepth,parentId:function getParentId(){var _newItems$slice$rever;if(0===depth||!previousItem)return null;if(depth<=previousItem.depth)return previousItem.parentId;if(depth>previousItem.depth)return previousItem.id;const newParent=null===(_newItems$slice$rever=newItems.slice(0,overItemIndex).reverse().find((item=>item.depth===depth)))||void 0===_newItems$slice$rever?void 0:_newItems$slice$rever.parentId;return null!=newParent?newParent:null}()}}function flatten(items=[],parentId=null,depth=0){return items.reduce(((acc,item,index)=>[...acc,(0,objectSpread2.c)((0,objectSpread2.c)({},item),{},{parentId:parentId,depth:depth,index:index}),...flatten(item.children,item.id,depth+1)]),[])}function flattenTree(items){return flatten(items)}var objectWithoutProperties=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),Loadable=__webpack_require__("./src/helpers/Loadable/Loadable.jsx");const _excluded=["clone","data","depth","disableSelection","disableInteraction","ghost","id","handleProps","indentationWidth","onRemove","onSelectBlock","parentId","style","value","wrapperRef","errors"];var Item_jsx=react.createElement;const Item=(0,react.forwardRef)(((_ref,ref)=>{var _config$blocks$blocks,_config$blocks$blocks2,_config$blocks$blocks3;let{clone:clone,data:data,depth:depth,disableSelection:disableSelection,disableInteraction:disableInteraction,ghost:ghost,id:id,handleProps:handleProps,indentationWidth:indentationWidth,onRemove:onRemove,onSelectBlock:onSelectBlock,parentId:parentId,style:style,value:value,wrapperRef:wrapperRef,errors:errors}=_ref,props=(0,objectWithoutProperties.c)(_ref,_excluded);const selected=(0,es.useSelector)((state=>state.form.ui.selected)),hovered=(0,es.useSelector)((state=>state.form.ui.hovered)),multiSelected=(0,es.useSelector)((state=>state.form.ui.multiSelected)),gridSelected=(0,es.useSelector)((state=>state.form.ui.gridSelected)),dispatch=(0,es.useDispatch)();return Item_jsx("li",(0,esm_extends.c)({className:classnames_default()("tree-item-wrapper",clone&&"clone",ghost&&"ghost",disableSelection&&"disable-selection",disableInteraction&&"disable-interaction"),role:"presentation",onMouseOver:()=>dispatch((0,form_form.i)({hovered:id})),onFocus:()=>dispatch((0,form_form.i)({hovered:id})),onMouseLeave:()=>dispatch((0,form_form.i)({hovered:null})),onClick:e=>{if(0===depth){const isMultipleSelection=e.shiftKey||e.ctrlKey||e.metaKey;selected!==id&&onSelectBlock(id,selected!==id&&isMultipleSelection,e)}else dispatch((0,form_form.i)({selected:parentId,multiSelected:[],gridSelected:id}))},ref:wrapperRef,style:{"--spacing":indentationWidth*depth+"px"}},props),Item_jsx("div",{className:classnames_default()("tree-item",(selected===id||gridSelected===id)&&"selected",hovered===id&&"hovered",includes_default()(multiSelected,id)&&"multiSelected",`depth-${depth}`),ref:ref,style:style},Item_jsx("button",(0,esm_extends.c)({ref:ref},handleProps,{className:classnames_default()("action","drag"),tabIndex:0,"data-cypress":"draggable-handle"}),Item_jsx(Icon.c,{name:drag_default(),size:"16px"})),Item_jsx("span",{className:classnames_default()("text",{errored:errors&&Object.keys(errors).length>0})},(null===(_config$blocks$blocks=registry.default.blocks.blocksConfig[null==data?void 0:data["@type"]])||void 0===_config$blocks$blocks?void 0:_config$blocks$blocks.icon)&&Item_jsx(Icon.c,{name:null===(_config$blocks$blocks2=registry.default.blocks.blocksConfig[null==data?void 0:data["@type"]])||void 0===_config$blocks$blocks2?void 0:_config$blocks$blocks2.icon,size:"20px",style:{verticalAlign:"middle"}})," ",(null==data?void 0:data.plaintext)||(null===(_config$blocks$blocks3=registry.default.blocks.blocksConfig[null==data?void 0:data["@type"]])||void 0===_config$blocks$blocks3?void 0:_config$blocks$blocks3.title)),!clone&&onRemove&&Item_jsx("button",{onClick:onRemove,className:classnames_default()("action","delete"),tabIndex:0},Item_jsx(Icon.c,{name:delete_default(),size:"18"}))))}));Item.__docgenInfo={description:"",methods:[],displayName:"Item"};const SortableItem_excluded=["id","depth","dndKitSortable","dndKitUtilities"];var SortableItem_jsx=react.createElement;const animateLayoutChanges=({isSorting:isSorting,wasDragging:wasDragging})=>!isSorting&&!wasDragging;function SortableItem(_ref){let{id:id,depth:depth,dndKitSortable:dndKitSortable,dndKitUtilities:dndKitUtilities}=_ref,props=(0,objectWithoutProperties.c)(_ref,SortableItem_excluded);const{useSortable:useSortable}=dndKitSortable,{CSS:CSS}=dndKitUtilities,{attributes:attributes,isDragging:isDragging,isSorting:isSorting,listeners:listeners,setDraggableNodeRef:setDraggableNodeRef,setDroppableNodeRef:setDroppableNodeRef,transform:transform,transition:transition}=useSortable({id:id,animateLayoutChanges:animateLayoutChanges}),style={transform:CSS.Translate.toString(transform),transition:transition};return SortableItem_jsx(Item,(0,esm_extends.c)({ref:setDraggableNodeRef,wrapperRef:setDroppableNodeRef,style:style,depth:depth,ghost:isDragging,disableSelection:!1,disableInteraction:isSorting,id:id,handleProps:(0,objectSpread2.c)((0,objectSpread2.c)({},attributes),listeners)},props))}var Order_SortableItem=(0,Loadable.yM)(["dndKitSortable","dndKitUtilities"])(SortableItem);SortableItem.__docgenInfo={description:"",methods:[],displayName:"SortableItem"};var Order_jsx=react.createElement;function Order({items:items=[],onMoveBlock:onMoveBlock,onDeleteBlock:onDeleteBlock,onSelectBlock:onSelectBlock,indentationWidth:indentationWidth=25,removable:removable,dndKitCore:dndKitCore,dndKitSortable:dndKitSortable,dndKitUtilities:dndKitUtilities,errors:errors}){const{0:activeId,1:setActiveId}=(0,react.useState)(null),{0:overId,1:setOverId}=(0,react.useState)(null),{0:offsetLeft,1:setOffsetLeft}=(0,react.useState)(0),{0:currentPosition,1:setCurrentPosition}=(0,react.useState)(null),{DndContext:DndContext,closestCenter:closestCenter,PointerSensor:PointerSensor,useSensor:useSensor,useSensors:useSensors,DragOverlay:DragOverlay,MeasuringStrategy:MeasuringStrategy,defaultDropAnimation:defaultDropAnimation}=dndKitCore,{SortableContext:SortableContext,arrayMove:arrayMove,verticalListSortingStrategy:verticalListSortingStrategy}=dndKitSortable,{CSS:CSS}=dndKitUtilities,measuring={droppable:{strategy:MeasuringStrategy.Always}},dropAnimationConfig={keyframes({transform:transform}){return[{opacity:1,transform:CSS.Transform.toString(transform.initial)},{opacity:0,transform:CSS.Transform.toString((0,objectSpread2.c)((0,objectSpread2.c)({},transform.final),{},{x:transform.final.x+5,y:transform.final.y+5}))}]},easing:"ease-out",sideEffects({active:active}){active.node.animate([{opacity:0},{opacity:1}],{duration:defaultDropAnimation.duration,easing:defaultDropAnimation.easing})}},flattenedItems=(0,react.useMemo)((()=>function removeChildrenOf(items,ids){const excludeParentIds=[...ids];return items.filter((item=>!item.parentId||!excludeParentIds.includes(item.parentId)||(item.children.length&&excludeParentIds.push(item.id),!1)))}(flattenTree(items),activeId?[activeId]:[])),[activeId,items]),projected=activeId&&overId?getProjection(flattenedItems,activeId,overId,offsetLeft,indentationWidth,arrayMove):null,sensorContext=(0,react.useRef)({items:flattenedItems,offset:offsetLeft}),sensors=useSensors(useSensor(PointerSensor)),sortedIds=(0,react.useMemo)((()=>flattenedItems.map((({id:id})=>id))),[flattenedItems]),activeItem=activeId?flattenedItems.find((({id:id})=>id===activeId)):null;(0,react.useEffect)((()=>{sensorContext.current={items:flattenedItems,offset:offsetLeft}}),[flattenedItems,offsetLeft]);return Order_jsx(DndContext,{accessibility:{announcements:{onDragStart({active:active}){return`Picked up ${active.id}.`},onDragMove({active:active,over:over}){return getMovementAnnouncement("onDragMove",active.id,null==over?void 0:over.id)},onDragOver({active:active,over:over}){return getMovementAnnouncement("onDragOver",active.id,null==over?void 0:over.id)},onDragEnd({active:active,over:over}){return getMovementAnnouncement("onDragEnd",active.id,null==over?void 0:over.id)},onDragCancel({active:active}){return`Moving was cancelled. ${active.id} was dropped in its original position.`}}},sensors:sensors,collisionDetection:closestCenter,measuring:measuring,onDragStart:function handleDragStart({active:{id:activeId}}){setActiveId(activeId),setOverId(activeId);const activeItem=flattenedItems.find((({id:id})=>id===activeId));activeItem&&setCurrentPosition({parentId:activeItem.parentId,overId:activeId});document.body.style.setProperty("cursor","grabbing")},onDragMove:function handleDragMove({delta:delta}){setOffsetLeft(delta.x)},onDragOver:function handleDragOver({over:over}){var _over$id;setOverId(null!==(_over$id=null==over?void 0:over.id)&&void 0!==_over$id?_over$id:null)},onDragEnd:function handleDragEnd({active:active,over:over}){if(projected&&over){const{depth:depth,parentId:parentId}=projected,clonedItems=JSON.parse(JSON.stringify(flattenedItems)),overIndex=clonedItems.findIndex((({id:id})=>id===over.id)),activeIndex=clonedItems.findIndex((({id:id})=>id===active.id)),activeTreeItem=clonedItems[activeIndex],oldParentId=activeTreeItem.parentId;if(clonedItems[activeIndex]=(0,objectSpread2.c)((0,objectSpread2.c)({},activeTreeItem),{},{depth:depth,parentId:parentId}),parentId===oldParentId){let destIndex=clonedItems[overIndex].index;clonedItems[overIndex].depth>clonedItems[activeIndex].depth&&(destIndex=find_default()(clonedItems,{id:clonedItems[overIndex].parentId}).index),onMoveBlock({source:{position:clonedItems[activeIndex].index,parent:oldParentId,id:active.id},destination:{position:destIndex,parent:parentId}})}else onMoveBlock(parentId&&oldParentId?{source:{position:clonedItems[activeIndex].index,parent:oldParentId,id:active.id},destination:{position:overIndex<activeIndex?clonedItems[overIndex-1].parentId?clonedItems[overIndex-1].index+1:clonedItems[overIndex].index:overIndex+1<clonedItems.length?clonedItems[overIndex+1].index:clonedItems[overIndex].index+1,parent:parentId}}:oldParentId?{source:{position:clonedItems[activeIndex].index,parent:oldParentId,id:active.id},destination:{position:overIndex>activeIndex?overIndex+1<clonedItems.length?clonedItems[overIndex+1].index:clonedItems[overIndex].index+1:clonedItems[overIndex].index,parent:parentId}}:{source:{position:clonedItems[activeIndex].index,parent:oldParentId,id:active.id},destination:{position:overIndex<activeIndex?clonedItems[overIndex-1].parentId?clonedItems[overIndex-1].index+1:clonedItems[overIndex].index:overIndex+1<clonedItems.length?clonedItems[overIndex+1].index:clonedItems[overIndex].index+1,parent:parentId}})}resetState()},onDragCancel:function handleDragCancel(){resetState()}},Order_jsx(SortableContext,{items:sortedIds,strategy:verticalListSortingStrategy},flattenedItems.map((({id:id,parentId:parentId,depth:depth,data:data})=>Order_jsx(Order_SortableItem,{key:id,id:id,parentId:parentId,data:data,depth:min_default()([id===activeId&&projected?projected.depth:depth,1]),indentationWidth:indentationWidth,onRemove:removable?()=>function handleRemove(id){onDeleteBlock(id)}(id):void 0,onSelectBlock:onSelectBlock,errors:(null==errors?void 0:errors[id])||{}}))),(0,react_dom.createPortal)(Order_jsx(DragOverlay,{dropAnimation:dropAnimationConfig},activeId&&activeItem?Order_jsx(Order_SortableItem,{id:activeId,depth:activeItem.depth,clone:!0,data:find_default()(flattenedItems,{id:activeId}).data,indentationWidth:indentationWidth}):null),document.body)));function resetState(){setOverId(null),setActiveId(null),setOffsetLeft(0),setCurrentPosition(null),document.body.style.setProperty("cursor","")}function getMovementAnnouncement(eventName,activeId,overId){if(overId&&projected){if("onDragEnd"!==eventName){if(currentPosition&&projected.parentId===currentPosition.parentId&&overId===currentPosition.overId)return;setCurrentPosition({parentId:projected.parentId,overId:overId})}const clonedItems=JSON.parse(JSON.stringify(flattenTree(items))),overIndex=clonedItems.findIndex((({id:id})=>id===overId)),activeIndex=clonedItems.findIndex((({id:id})=>id===activeId)),sortedItems=arrayMove(clonedItems,activeIndex,overIndex),previousItem=sortedItems[overIndex-1];let announcement;const movedVerb="onDragEnd"===eventName?"dropped":"moved",nestedVerb="onDragEnd"===eventName?"dropped":"nested";if(previousItem)if(projected.depth>previousItem.depth)announcement=`${activeId} was ${nestedVerb} under ${previousItem.id}.`;else{let previousSibling=previousItem;for(;previousSibling&&projected.depth<previousSibling.depth;){const parentId=previousSibling.parentId;previousSibling=sortedItems.find((({id:id})=>id===parentId))}previousSibling&&(announcement=`${activeId} was ${movedVerb} after ${previousSibling.id}.`)}else{const nextItem=sortedItems[overIndex+1];announcement=`${activeId} was ${movedVerb} before ${nextItem.id}.`}return announcement}}}var Order_Order=(0,Loadable.yM)(["dndKitCore","dndKitSortable","dndKitUtilities"])(Order);Order.__docgenInfo={description:"",methods:[],displayName:"Order",props:{items:{defaultValue:{value:"[]",computed:!1},required:!1},indentationWidth:{defaultValue:{value:"25",computed:!1},required:!1}}};var BlocksForm_jsx=react.createElement;const BlocksForm=props=>{const{pathname:pathname,onChangeField:onChangeField,properties:properties,type:type,navRoot:navRoot,onChangeFormData:onChangeFormData,selectedBlock:selectedBlock,multiSelected:multiSelected,onSelectBlock:onSelectBlock,allowedBlocks:allowedBlocks,showRestricted:showRestricted,title:title,description:description,metadata:metadata,manage:manage,children:children,isMainForm:isMainForm=!0,isContainer:isContainer,stopPropagation:stopPropagation,disableAddBlockOnEnterKey:disableAddBlockOnEnterKey,blocksConfig:blocksConfig=registry.default.blocks.blocksConfig,editable:editable=!0,direction:direction="vertical",history:history,location:location,token:token,errors:errors,blocksErrors:blocksErrors}=props,{0:isClient,1:setIsClient}=(0,react.useState)(!1);(0,react.useEffect)((()=>{setIsClient(!0)}),[]);const blockList=(0,Blocks.oZ)(properties),dispatch=(0,es.useDispatch)(),intl=(0,useIntl.c)(),ref=(0,useDetectClickOutside.o)({onTriggered:()=>{onSelectBlock(null),dispatch((0,sidebar.Of)(0))},triggerKeys:["Escape"],disableClick:!0,disableKeys:!isMainForm}),handleKeyDown=(e,index,block,node,{disableEnter:disableEnter=!1,disableArrowUp:disableArrowUp=!1,disableArrowDown:disableArrowDown=!1}={})=>{const isMultipleSelection=e.shiftKey;"ArrowUp"!==e.key||disableArrowUp||(onFocusPreviousBlock(block,node,isMultipleSelection),e.preventDefault()),"ArrowDown"!==e.key||disableArrowDown||(onFocusNextBlock(block,node,isMultipleSelection),e.preventDefault());const blockConfig=blocksConfig[properties[(0,Blocks.c$)(properties)][block]["@type"]];"Enter"!==e.key||disableEnter||blockConfig.disableEnter||(disableAddBlockOnEnterKey||onSelectBlock(onAddBlock(registry.default.settings.defaultBlockType,index+1)),e.preventDefault())},onFocusPreviousBlock=(currentBlock,blockNode,isMultipleSelection)=>{const prev=(0,Blocks.ay)(properties,currentBlock);null!==prev&&(blockNode.blur(),onSelectBlock(prev,isMultipleSelection))},onFocusNextBlock=(currentBlock,blockNode,isMultipleSelection)=>{const next=(0,Blocks.Ix)(properties,currentBlock);null!==next&&(blockNode.blur(),onSelectBlock(next,isMultipleSelection))},onMutateBlock=(id,value)=>{const newFormData=(0,Blocks.I5)(properties,id,value,null,intl);onChangeFormData(newFormData)},onInsertBlock=(id,value,current)=>{const[newId,newFormData]=(0,Blocks.op)(properties,id,value,current,registry.default.experimental.addBlockButton.enabled?1:0,null,intl),blocksFieldname=(0,Blocks.c$)(newFormData),blockData=newFormData[blocksFieldname][newId];return newFormData[blocksFieldname][newId]=(0,Blocks.Qd)({data:blockData,intl:intl,metadata:metadata,properties:properties}),onChangeFormData(newFormData),newId},onAddBlock=(type,index)=>{if(editable){const[id,newFormData]=(0,Blocks.Ub)(properties,type,index,null,intl),blocksFieldname=(0,Blocks.c$)(newFormData),blockData=newFormData[blocksFieldname][id];return newFormData[blocksFieldname][id]=(0,Blocks.Qd)({data:blockData,intl:intl,metadata:metadata,properties:properties}),onChangeFormData(newFormData),id}},onChangeBlock=(id,value)=>{const newFormData=(0,Blocks.cL)(properties,id,value);onChangeFormData(newFormData)},onDeleteBlock=(id,selectPrev)=>{const previous=(0,Blocks.ay)(properties,id),newFormData=(0,Blocks.kV)(properties,id,intl);onChangeFormData(newFormData),onSelectBlock(selectPrev?previous:null)},onMoveBlock=(dragIndex,hoverIndex)=>{const newFormData=(0,Blocks.SS)(properties,dragIndex,hoverIndex);onChangeFormData(newFormData)},editBlockWrapper=children||(({draginfo:draginfo},editBlock,blockProps)=>BlocksForm_jsx(Block_EditBlockWrapper,{draginfo:draginfo,blockProps:blockProps},editBlock));for(const[n,v]of blockList)if(!v){const newFormData=(0,Blocks.kV)(properties,n,intl);onChangeFormData(newFormData)}return function useEvent(event,handler){(0,react.useEffect)((()=>(document.addEventListener(event,handler),function cleanup(){document.removeEventListener(event,handler)})))}("voltoClickBelowContent",(()=>{registry.default.experimental.addBlockButton.enabled&&isMainForm&&onSelectBlock(onAddBlock(registry.default.settings.defaultBlockType,blockList.length))})),BlocksForm_jsx(react.Fragment,null,isMainForm&&isClient&&(0,react_dom.createPortal)(BlocksForm_jsx("div",null,BlocksForm_jsx(Order_Order,{items:(0,Blocks.us)(properties),onMoveBlock:({source:source,destination:destination})=>{const newFormData=(0,Blocks.y_)(cloneDeep_default()(properties),{source:source,destination:destination}),blocksFieldname=(0,Blocks.c$)(newFormData),blocksLayoutFieldname=(0,Blocks.Ar)(newFormData);let error=!1;const allowedBlocks=Object.keys(blocksConfig);map_default()(newFormData[blocksLayoutFieldname].items,(id=>{var _block$blocksLayoutFi;const block=newFormData[blocksFieldname][id];if(allowedBlocks.includes(block["@type"])||(error=!0),Array.isArray(null===(_block$blocksLayoutFi=block[blocksLayoutFieldname])||void 0===_block$blocksLayoutFi?void 0:_block$blocksLayoutFi.items)){const size=block[blocksLayoutFieldname].items.length,allowedSubBlocks=[...blocksConfig[block["@type"]].allowedBlocks||allowedBlocks,"empty"]||["empty"];(size<1||size>(blocksConfig[block["@type"]].maxLength||4))&&(error=!0),map_default()(block[blocksLayoutFieldname].items,(subId=>{const subBlock=block[blocksFieldname][subId];allowedSubBlocks.includes(subBlock["@type"])||(error=!0)}))}})),error||(onChangeFormData(newFormData),dispatch((0,form_form.i)({selected:null,multiSelected:[],gridSelected:null})))},onDeleteBlock:onDeleteBlock,onSelectBlock:onSelectBlock,removable:!0,errors:blocksErrors})),document.getElementById("sidebar-order")),BlocksForm_jsx("div",{className:"blocks-form",role:"presentation",ref:ref,onKeyDown:e=>{stopPropagation&&e.stopPropagation()}},BlocksForm_jsx("fieldset",{className:"invisible",disabled:!editable},BlocksForm_jsx(DragDropList.c,{childList:blockList,onMoveItem:result=>{const{source:source,destination:destination}=result;if(!destination)return;const newFormData=(0,Blocks.SS)(properties,source.index,destination.index);return onChangeFormData(newFormData),!0},direction:direction},(dragProps=>{const{child:child,childId:childId,index:index}=dragProps,blockProps={allowedBlocks:allowedBlocks,showRestricted:showRestricted,block:childId,data:child,handleKeyDown:handleKeyDown,id:childId,formTitle:title,formDescription:description,index:index,manage:manage,onAddBlock:onAddBlock,onInsertBlock:onInsertBlock,onChangeBlock:onChangeBlock,onChangeField:onChangeField,onChangeFormData:onChangeFormData,onDeleteBlock:onDeleteBlock,onFocusNextBlock:onFocusNextBlock,onFocusPreviousBlock:onFocusPreviousBlock,onMoveBlock:onMoveBlock,onMutateBlock:onMutateBlock,onSelectBlock:onSelectBlock,pathname:pathname,metadata:metadata,properties:properties,contentType:type,navRoot:navRoot,blocksConfig:blocksConfig,selected:selectedBlock===childId,multiSelected:null==multiSelected?void 0:multiSelected.includes(childId),type:child["@type"],editable:editable,showBlockChooser:selectedBlock===childId,detached:isContainer,content:properties,history:history,location:location,token:token,errors:errors,blocksErrors:blocksErrors};return editBlockWrapper(dragProps,BlocksForm_jsx(Block_Edit,(0,esm_extends.c)({key:childId},blockProps)),blockProps)})))))};var Block_BlocksForm=BlocksForm;BlocksForm.__docgenInfo={description:"",methods:[],displayName:"BlocksForm"}},"./src/components/manage/DragDropList/DragDropList.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/extends.js"),_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),lodash_isEmpty__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEmpty.js"),lodash_isEmpty__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_isEmpty__WEBPACK_IMPORTED_MODULE_1__),_plone_volto_helpers_Loadable_Loadable__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/helpers/Loadable/Loadable.jsx"),uuid__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../../node_modules/.pnpm/uuid@8.3.2/node_modules/uuid/dist/esm-browser/v4.js"),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;const getVerticalPlaceholder=(draggedDOM,sourceIndex,destinationIndex,parentDOM)=>{const childrenArray=[...parentDOM.children];childrenArray.splice(sourceIndex,1),childrenArray.splice(-1,1);const parentRect=parentDOM.getBoundingClientRect(),prevNode=childrenArray[destinationIndex-1],nextNode=childrenArray[destinationIndex];let top,bottom;if(prevNode){const prevRect=prevNode.getBoundingClientRect();top=prevRect.top+prevRect.height-parentRect.top}else top=0;if(nextNode){bottom=nextNode.getBoundingClientRect().top-parentRect.top}else bottom=parentRect.bottom+draggedDOM.getBoundingClientRect().height-parentRect.top;return{clientY:top,clientHeight:bottom-top,clientX:parseFloat(window.getComputedStyle(parentDOM).paddingLeft),clientWidth:draggedDOM.clientWidth}},getHorizontalPlaceholder=(draggedDOM,destinationIndex,parentDOM)=>{const parentRect=parentDOM.getBoundingClientRect();let height;height=parentRect.bottom-parentRect.top;let clientWidth=draggedDOM.clientWidth,innerDroppablePlaceholderMarginLeft=parentDOM.children[destinationIndex].getBoundingClientRect().x;return parentDOM.children.length-1===destinationIndex&&(innerDroppablePlaceholderMarginLeft=parentRect.x,clientWidth=parentDOM.getBoundingClientRect().width),{clientY:0,clientHeight:height,clientX:parseFloat(innerDroppablePlaceholderMarginLeft-parentRect.x),clientWidth:clientWidth}},DragDropList=props=>{const{childList:childList,children:children,direction:direction="vertical",onMoveItem:onMoveItem,as:as="div",style:style,forwardedAriaLabelledBy:forwardedAriaLabelledBy,reactBeautifulDnd:reactBeautifulDnd}=props,{DragDropContext:DragDropContext,Draggable:Draggable,Droppable:Droppable}=reactBeautifulDnd,[placeholderProps,setPlaceholderProps]=react__WEBPACK_IMPORTED_MODULE_0__.useState({}),[uid]=react__WEBPACK_IMPORTED_MODULE_0__.useState((0,uuid__WEBPACK_IMPORTED_MODULE_3__.c)()),timer=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),parentRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),onDragStart=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((event=>{clearTimeout(timer.current);const domQuery=`[data-rbd-draggable-id='${event.draggableId}']`,draggedDOM=document.querySelector(domQuery);if(!draggedDOM)return;const sourceIndex=event.source.index;setPlaceholderProps("horizontal"===direction?getHorizontalPlaceholder(draggedDOM,sourceIndex,parentRef.current):getVerticalPlaceholder(draggedDOM,sourceIndex,sourceIndex,parentRef.current))}),[direction]),onDragEnd=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((result=>{clearTimeout(timer.current),onMoveItem(result),setPlaceholderProps({})}),[onMoveItem]),onDragUpdate=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((update=>{if(clearTimeout(timer.current),setPlaceholderProps({}),!update.destination)return;const domQuery=`[data-rbd-draggable-id='${update.draggableId}']`,draggedDOM=document.querySelector(domQuery);if(!draggedDOM)return;const sourceIndex=update.source.index,destinationIndex=update.destination.index;timer.current=setTimeout((()=>{setPlaceholderProps("horizontal"===direction?getHorizontalPlaceholder(draggedDOM,destinationIndex,parentRef.current):getVerticalPlaceholder(draggedDOM,sourceIndex,destinationIndex,parentRef.current))}),250)}),[direction]),AsDomComponent=as;return __jsx(DragDropContext,{onDragStart:onDragStart,onDragUpdate:onDragUpdate,onDragEnd:onDragEnd},__jsx(Droppable,{droppableId:uid,direction:direction,renderClone:(provided,snapshot,rubric)=>{const index=rubric.source.index;return children({child:childList[index][1],childId:childList[index][0],index:index,draginfo:provided})}},((provided,snapshot)=>__jsx(AsDomComponent,(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_4__.c)({ref:el=>{provided.innerRef(el),parentRef.current=el}},provided.droppableProps,{style:(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.c)((0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.c)({},style),{},{position:"relative"}),"aria-labelledby":forwardedAriaLabelledBy}),childList.filter((([id,child])=>id&&child)).map((([childId,child],index)=>__jsx(Draggable,{draggableId:childId.toString(),index:index,key:childId,style:{userSelect:"none"}},(draginfo=>children({child:child,childId:childId,index:index,draginfo:draginfo}))))),provided.placeholder,!lodash_isEmpty__WEBPACK_IMPORTED_MODULE_1___default()(placeholderProps)&&snapshot.isDraggingOver&&__jsx("div",{style:(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.c)({position:"absolute",top:placeholderProps.clientY,left:placeholderProps.clientX,height:placeholderProps.clientHeight,background:"#eee",width:placeholderProps.clientWidth,borderRadius:"3px"},"horizontal"===direction&&{zIndex:-1})})))))};__webpack_exports__.c=(0,_plone_volto_helpers_Loadable_Loadable__WEBPACK_IMPORTED_MODULE_2__.yM)(["reactBeautifulDnd"])(DragDropList),DragDropList.__docgenInfo={description:"",methods:[],displayName:"DragDropList"}},"./src/components/manage/Form/BlockDataForm.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return BlockDataForm}});var _home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/extends.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_plone_volto_components_manage_Form__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/manage/Form/index.tsx"),_plone_volto_helpers_Extensions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/helpers/Extensions/index.js"),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;const EnhancedBlockDataForm=(0,_plone_volto_helpers_Extensions__WEBPACK_IMPORTED_MODULE_2__.cz)(_plone_volto_components_manage_Form__WEBPACK_IMPORTED_MODULE_1__.v1);function BlockDataForm(props){const{onChangeBlock:onChangeBlock,block:block,applySchemaEnhancers:applySchemaEnhancers=!0}=props;onChangeBlock||console.warn("BlockDataForm component is used without passing down onChangeBlock as props");const onChangeFormData=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((data=>onChangeBlock(block,data)),[block,onChangeBlock]),Form=applySchemaEnhancers?EnhancedBlockDataForm:_plone_volto_components_manage_Form__WEBPACK_IMPORTED_MODULE_1__.v1;return __jsx(Form,(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_3__.c)({},props,{onChangeFormData:onChangeBlock?onChangeFormData:void 0}))}BlockDataForm.__docgenInfo={description:"",methods:[],displayName:"BlockDataForm"}},"./src/components/manage/Form/BlocksToolbar.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BlocksToolbarComponent:function(){return BlocksToolbarComponent},default:function(){return BlocksToolbar}});var objectSpread2=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),redux=__webpack_require__("../../../node_modules/.pnpm/redux@4.2.1/node_modules/redux/es/redux.js"),es=__webpack_require__("../../../node_modules/.pnpm/react-redux@8.1.2_@types+react-dom@18.3.6_@types+react@18.3.20__@types+react@18.3.20_react-do_nbjh6ntydbqdrzuehcvsgmxwbi/node_modules/react-redux/es/index.js"),injectIntl=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/injectIntl.js"),MessageLabels=__webpack_require__("./src/helpers/MessageLabels/MessageLabels.js"),Blocks=__webpack_require__("./src/helpers/Blocks/Blocks.js"),Icon=__webpack_require__("./src/components/theme/Icon/Icon.jsx"),Pluggable=__webpack_require__("./src/components/manage/Pluggable/index.js"),v4=__webpack_require__("../../../node_modules/.pnpm/uuid@8.3.2/node_modules/uuid/dist/esm-browser/v4.js"),dist=__webpack_require__("../../../node_modules/.pnpm/redux-localstorage-simple@2.5.1/node_modules/redux-localstorage-simple/dist/index.js"),isEqual=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEqual.js"),isEqual_default=__webpack_require__.n(isEqual),omit=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/omit.js"),omit_default=__webpack_require__.n(omit),without=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/without.js"),without_default=__webpack_require__.n(without),ActionTypes=__webpack_require__("./src/constants/ActionTypes.js");var registry=__webpack_require__("./src/registry.js"),copy=__webpack_require__("./src/icons/copy.svg"),copy_default=__webpack_require__.n(copy),cut=__webpack_require__("./src/icons/cut.svg"),cut_default=__webpack_require__.n(cut),paste=__webpack_require__("./src/icons/paste.svg"),paste_default=__webpack_require__.n(paste),icons_delete=__webpack_require__("./src/icons/delete.svg"),delete_default=__webpack_require__.n(icons_delete),registry_dist=__webpack_require__("../registry/dist/index.js");function cloneBlocks(blocksData){if((0,Blocks.I1)(blocksData)){const blocksFieldname=(0,Blocks.c$)(blocksData),blocksLayoutFieldname=(0,Blocks.Ar)(blocksData),cloneWithIds=Object.keys(blocksData.blocks).map((key=>{const block=blocksData.blocks[key],blockConfig=registry_dist.c.blocks.blocksConfig[blocksData["@type"]];return null!=blockConfig&&blockConfig.cloneData?blockConfig.cloneData(block):[(0,v4.c)(),cloneBlocks(block)]})).filter((info=>!!info));return(0,objectSpread2.c)((0,objectSpread2.c)({},blocksData),{},{[blocksFieldname]:(0,objectSpread2.c)({},Object.assign({},...cloneWithIds.map((([id,data])=>({[id]:data}))))),[blocksLayoutFieldname]:(0,objectSpread2.c)((0,objectSpread2.c)({},blocksData[blocksLayoutFieldname]),{},{items:[...cloneWithIds.map((([id])=>id))]})})}return blocksData}var __jsx=react.createElement;class BlocksToolbarComponent extends react.Component{constructor(props){super(props),this.copyBlocksToClipboard=this.copyBlocksToClipboard.bind(this),this.cutBlocksToClipboard=this.cutBlocksToClipboard.bind(this),this.deleteBlocks=this.deleteBlocks.bind(this),this.loadFromStorage=this.loadFromStorage.bind(this),this.pasteBlocks=this.pasteBlocks.bind(this),this.setBlocksClipboard=this.setBlocksClipboard.bind(this)}loadFromStorage(){var _load;const clipboard=null===(_load=(0,dist.AJ)({states:["blocksClipboard"]}))||void 0===_load?void 0:_load.blocksClipboard;isEqual_default()(clipboard,this.props.blocksClipboard)||this.props.setBlocksClipboard(clipboard||{})}componentDidMount(){window.addEventListener("storage",this.loadFromStorage,!0)}componentWillUnmount(){window.removeEventListener("storage",this.loadFromStorage)}deleteBlocks(){const blockIds=this.props.selectedBlocks,{formData:formData}=this.props,blocksFieldname=(0,Blocks.c$)(formData),blocksLayoutFieldname=(0,Blocks.Ar)(formData);this.props.onSelectBlock(null);const newBlockData={[blocksFieldname]:omit_default()(formData[blocksFieldname],blockIds),[blocksLayoutFieldname]:(0,objectSpread2.c)((0,objectSpread2.c)({},formData[blocksLayoutFieldname]),{},{items:without_default()(formData[blocksLayoutFieldname].items,...blockIds)})};this.props.onChangeBlocks(newBlockData)}copyBlocksToClipboard(){this.setBlocksClipboard("copy")}cutBlocksToClipboard(){this.setBlocksClipboard("cut"),this.deleteBlocks()}setBlocksClipboard(actionType){const{formData:formData}=this.props,blocks=formData[(0,Blocks.c$)(formData)],blocksData=this.props.selectedBlocks.map((blockId=>[blockId,blocks[blockId]])).filter((([blockId])=>!!blockId));this.props.setBlocksClipboard({[actionType]:blocksData}),this.props.onSetSelectedBlocks([])}pasteBlocks(e){const{formData:formData,blocksClipboard:blocksClipboard={},selectedBlock:selectedBlock}=this.props,mode=Object.keys(blocksClipboard).includes("cut")?"cut":"copy",cloneWithIds=(blocksClipboard[mode]||[]).filter((([blockId,blockData])=>blockId&&!!blockData["@type"])).map((([blockId,blockData])=>{const blockConfig=registry.default.blocks.blocksConfig[blockData["@type"]];return"copy"===mode?blockConfig.cloneData?blockConfig.cloneData(blockData):[(0,v4.c)(),cloneBlocks(blockData)]:[blockId,blockData]})).filter((info=>!!info)),blocksFieldname=(0,Blocks.c$)(formData),blocksLayoutFieldname=(0,Blocks.Ar)(formData),selectedIndex=formData[blocksLayoutFieldname].items.indexOf(selectedBlock)+1,newBlockData={[blocksFieldname]:(0,objectSpread2.c)((0,objectSpread2.c)({},formData[blocksFieldname]),Object.assign({},...cloneWithIds.map((([id,data])=>({[id]:data}))))),[blocksLayoutFieldname]:(0,objectSpread2.c)((0,objectSpread2.c)({},formData[blocksLayoutFieldname]),{},{items:[...formData[blocksLayoutFieldname].items.slice(0,selectedIndex),...cloneWithIds.map((([id])=>id)),...formData[blocksLayoutFieldname].items.slice(selectedIndex)]})};e.ctrlKey||e.metaKey||this.props.resetBlocksClipboard(),this.props.onChangeBlocks(newBlockData)}render(){const{blocksClipboard:blocksClipboard={},selectedBlock:selectedBlock,selectedBlocks:selectedBlocks,intl:intl}=this.props;return __jsx(react.Fragment,null,selectedBlocks.length>0?__jsx(react.Fragment,null,__jsx(Pluggable.mQ,{pluggable:"main.toolbar.bottom",id:"blocks-delete-btn"},__jsx("button",{"aria-label":intl.formatMessage(MessageLabels.c.deleteBlocks),onClick:this.deleteBlocks,tabIndex:0,className:"deleteBlocks",id:"toolbar-delete-blocks"},__jsx(Icon.c,{name:delete_default(),size:"30px"}))),__jsx(Pluggable.mQ,{pluggable:"main.toolbar.bottom",id:"blocks-cut-btn"},__jsx("button",{"aria-label":intl.formatMessage(MessageLabels.c.cutBlocks),onClick:this.cutBlocksToClipboard,tabIndex:0,className:"cutBlocks",id:"toolbar-cut-blocks"},__jsx(Icon.c,{name:cut_default(),size:"30px"}))),__jsx(Pluggable.mQ,{pluggable:"main.toolbar.bottom",id:"blocks-copy-btn"},__jsx("button",{"aria-label":intl.formatMessage(MessageLabels.c.copyBlocks),onClick:this.copyBlocksToClipboard,tabIndex:0,className:"copyBlocks",id:"toolbar-copy-blocks"},__jsx(Icon.c,{name:copy_default(),size:"30px"})))):"",selectedBlock&&((null==blocksClipboard?void 0:blocksClipboard.cut)||(null==blocksClipboard?void 0:blocksClipboard.copy))&&__jsx(Pluggable.mQ,{pluggable:"main.toolbar.bottom",id:"block-paste-btn",dependencies:[selectedBlock]},__jsx("button",{"aria-label":intl.formatMessage(MessageLabels.c.pasteBlocks),onClick:this.pasteBlocks,tabIndex:0,className:"pasteBlocks",id:"toolbar-paste-blocks"},__jsx("span",{className:"blockCount"},(blocksClipboard.cut||blocksClipboard.copy).length),__jsx(Icon.c,{name:paste_default(),size:"30px"}))))}}var BlocksToolbar=(0,redux.compose)(injectIntl.cp,(0,es.connect)((state=>({blocksClipboard:(null==state?void 0:state.blocksClipboard)||{}})),{setBlocksClipboard:function setBlocksClipboard(payload){return(0,objectSpread2.c)({type:ActionTypes.WA},Object.assign({},payload.cut?{cut:payload.cut.filter((b=>!!b))}:{},payload.copy?{copy:payload.copy.filter((b=>!!b))}:{}))},resetBlocksClipboard:function resetBlocksClipboard(){return{type:ActionTypes.k9}}}))(BlocksToolbarComponent);BlocksToolbarComponent.__docgenInfo={description:"",methods:[{name:"loadFromStorage",docblock:null,modifiers:[],params:[],returns:null},{name:"deleteBlocks",docblock:null,modifiers:[],params:[],returns:null},{name:"copyBlocksToClipboard",docblock:null,modifiers:[],params:[],returns:null},{name:"cutBlocksToClipboard",docblock:null,modifiers:[],params:[],returns:null},{name:"setBlocksClipboard",docblock:null,modifiers:[],params:[{name:"actionType",optional:!1,type:null}],returns:null},{name:"pasteBlocks",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null}],displayName:"BlocksToolbarComponent"}},"./src/components/manage/Form/Field.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),react_intl__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/injectIntl.js"),_plone_volto_registry__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/registry.js"),_plone_volto_helpers_Loadable_Loadable__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/helpers/Loadable/Loadable.jsx");const _excluded=["connectDropTarget","connectDragSource","connectDragPreview"];var __jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;const getWidgetDefault=widgets=>widgets.default,UnconnectedField=(props,{intl:intl})=>{const widgets=props.widgets||_plone_volto_registry__WEBPACK_IMPORTED_MODULE_1__.default.widgets,Widget=((widgets,id)=>widgets.id[id]||null)(widgets,props.id)||((widgets,widgetOptions)=>{var _widgetOptions$fronte;return"string"==typeof(null==widgetOptions||null===(_widgetOptions$fronte=widgetOptions.frontendOptions)||void 0===_widgetOptions$fronte?void 0:_widgetOptions$fronte.widget)?widgets.widget[widgetOptions.frontendOptions.widget]:null})(widgets,props.widgetOptions)||((widgets,widget)=>"string"==typeof widget?widgets.widget[widget]||getWidgetDefault(widgets):null)(widgets,props.widget)||((widgets,props)=>props.choices||props.vocabulary?widgets.choices:null)(widgets,props)||((widgets,vocabulary)=>vocabulary&&vocabulary["@id"]?widgets.vocabulary[vocabulary["@id"].replace(/^.*\/@vocabularies\//,"")]:null)(widgets,props.vocabulary)||((widgets,props)=>props.widgetOptions&&props.widgetOptions.vocabulary?widgets.vocabulary[props.widgetOptions.vocabulary["@id"].replace(/^.*\/@vocabularies\//,"")]:null)(widgets,props)||((widgets,factory)=>{var _widgets$factory;return(null===(_widgets$factory=widgets.factory)||void 0===_widgets$factory?void 0:_widgets$factory[factory])||null})(widgets,props.factory)||((widgets,type)=>widgets.type[type]||null)(widgets,props.type)||getWidgetDefault(widgets);if("hidden"===props.mode)return null;const widgetProps=(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.c)((0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.c)({},props),"object"==typeof(null==(widgetOptions=props.widgetOptions)||null===(_widgetOptions$fronte2=widgetOptions.frontendOptions)||void 0===_widgetOptions$fronte2?void 0:_widgetOptions$fronte2.widgetProps)?widgetOptions.frontendOptions.widgetProps:null);var widgetOptions,_widgetOptions$fronte2;if(props.onOrder){const{DropTarget:DropTarget,DragSource:DragSource}=props.reactDnd,WrappedWidget=DropTarget("field",{hover(properties,monitor){const dragOrder=monitor.getItem().order,hoverOrder=properties.order;dragOrder!==hoverOrder&&(properties.onOrder(dragOrder,hoverOrder-dragOrder),monitor.getItem().order=hoverOrder)}},(connect=>({connectDropTarget:connect.dropTarget()})))(DragSource("field",{beginDrag(properties){return{id:properties.label,order:properties.order}}},((connect,monitor)=>({connectDragSource:connect.dragSource(),connectDragPreview:connect.dragPreview(),isDragging:monitor.isDragging()})))((_ref=>{let{connectDropTarget:connectDropTarget,connectDragSource:connectDragSource,connectDragPreview:connectDragPreview}=_ref,rest=(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_4__.c)(_ref,_excluded);return connectDropTarget(connectDragSource(connectDragPreview(__jsx("div",null,__jsx(Widget,rest)))))})));return __jsx(WrappedWidget,widgetProps)}return __jsx(Widget,widgetProps)},DndConnectedField=(0,_plone_volto_helpers_Loadable_Loadable__WEBPACK_IMPORTED_MODULE_2__.yM)(["reactDnd"])(UnconnectedField),Field=props=>props.onOrder?__jsx(DndConnectedField,props):__jsx(UnconnectedField,props);Field.defaultProps={widget:null,vocabulary:null,choices:null,type:"string",focus:!1,onOrder:null},__webpack_exports__.default=(0,react_intl__WEBPACK_IMPORTED_MODULE_5__.cp)(Field),Field.__docgenInfo={description:"",methods:[],displayName:"Field",props:{widget:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},vocabulary:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"shape",value:{"@id":{name:"string",required:!1}}},required:!1},choices:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"arrayOf",value:{name:"arrayOf",value:{name:"string"}}},required:!1},type:{defaultValue:{value:"'string'",computed:!1},description:"",type:{name:"string"},required:!1},focus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},onOrder:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},id:{description:"",type:{name:"string"},required:!0}}}},"./src/components/manage/Form/Form.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return manage_Form_Form}});var esm_extends=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/extends.js"),objectSpread2=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),defineProperty=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),Icon=__webpack_require__("./src/components/theme/Icon/Icon.jsx"),Toast=__webpack_require__("./src/components/manage/Toast/Toast.jsx"),manage_Form=__webpack_require__("./src/components/manage/Form/index.tsx"),BlocksToolbar=__webpack_require__("./src/components/manage/Form/BlocksToolbar.jsx"),UndoToolbar=__webpack_require__("./src/components/manage/Form/UndoToolbar.jsx"),Utils=__webpack_require__("./src/helpers/Utils/Utils.jsx"),FormValidation=__webpack_require__("./src/helpers/FormValidation/FormValidation.jsx"),Blocks=__webpack_require__("./src/helpers/Blocks/Blocks.js"),withBlockSchemaEnhancer=__webpack_require__("./src/helpers/Extensions/withBlockSchemaEnhancer.jsx"),MessageLabels=__webpack_require__("./src/helpers/MessageLabels/MessageLabels.js"),ahead=__webpack_require__("./src/icons/ahead.svg"),ahead_default=__webpack_require__.n(ahead),clear=__webpack_require__("./src/icons/clear.svg"),clear_default=__webpack_require__.n(clear),up_key=__webpack_require__("./src/icons/up-key.svg"),up_key_default=__webpack_require__.n(up_key),down_key=__webpack_require__("./src/icons/down-key.svg"),down_key_default=__webpack_require__.n(down_key),findIndex=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/findIndex.js"),findIndex_default=__webpack_require__.n(findIndex),isEmpty=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEmpty.js"),isEmpty_default=__webpack_require__.n(isEmpty),isEqual=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEqual.js"),isEqual_default=__webpack_require__.n(isEqual),keys=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/keys.js"),keys_default=__webpack_require__.n(keys),map=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/map.js"),map_default=__webpack_require__.n(map),mapValues=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/mapValues.js"),mapValues_default=__webpack_require__.n(mapValues),pickBy=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/pickBy.js"),pickBy_default=__webpack_require__.n(pickBy),without=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/without.js"),without_default=__webpack_require__.n(without),cloneDeep=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/cloneDeep.js"),cloneDeep_default=__webpack_require__.n(cloneDeep),xor=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/xor.js"),xor_default=__webpack_require__.n(xor),isBoolean=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isBoolean.js"),isBoolean_default=__webpack_require__.n(isBoolean),react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),injectIntl=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/injectIntl.js"),react_dom=__webpack_require__("../../../node_modules/.pnpm/react-dom@18.2.0_react@18.2.0/node_modules/react-dom/index.js"),es=__webpack_require__("../../../node_modules/.pnpm/react-redux@8.1.2_@types+react-dom@18.3.6_@types+react@18.3.20__@types+react@18.3.20_react-do_nbjh6ntydbqdrzuehcvsgmxwbi/node_modules/react-redux/es/index.js"),Container_Container=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Container/Container.js"),Form_Form=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/collections/Form/Form.js"),Button=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Button/Button.js"),Accordion=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/modules/Accordion/Accordion.js"),Segment=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Segment/Segment.js"),Tab=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/modules/Tab/Tab.js"),Message=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/collections/Message/Message.js"),v4=__webpack_require__("../../../node_modules/.pnpm/uuid@8.3.2/node_modules/uuid/dist/esm-browser/v4.js"),react_toastify=__webpack_require__("../../../node_modules/.pnpm/react-toastify@5.5.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/react-toastify/esm/react-toastify.js"),sidebar=__webpack_require__("./src/actions/sidebar/sidebar.js"),form_form=__webpack_require__("./src/actions/form/form.js"),redux=__webpack_require__("../../../node_modules/.pnpm/redux@4.2.1/node_modules/redux/es/redux.js"),registry=__webpack_require__("./src/registry.js"),react_router=__webpack_require__("../../../node_modules/.pnpm/react-router@5.2.0_react@18.2.0/node_modules/react-router/esm/react-router.js"),__jsx=react.createElement;const SlotRenderer=({name:name,content:content,navRoot:navRoot})=>{var _content$Components,_content$Components$n;const location=(0,react_router.IT)();let slots=registry.default.getSlot(name,{content:content,location:location,navRoot:(null==content||null===(_content$Components=content["@components"])||void 0===_content$Components||null===(_content$Components$n=_content$Components.navroot)||void 0===_content$Components$n?void 0:_content$Components$n.navroot)||navRoot});return slots?__jsx(react.Fragment,null,slots.map((({component:component,name:name})=>__jsx(component,{key:name,content:content,location:location,navRoot:navRoot})))):null};var SlotRenderer_SlotRenderer=SlotRenderer;try{SlotRenderer.displayName="SlotRenderer",SlotRenderer.__docgenInfo={description:"",displayName:"SlotRenderer",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"Content"}},navRoot:{defaultValue:null,description:"",name:"navRoot",required:!1,type:{name:"Content"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/theme/SlotRenderer/SlotRenderer.tsx#SlotRenderer"]={docgenInfo:SlotRenderer.__docgenInfo,name:"SlotRenderer",path:"src/components/theme/SlotRenderer/SlotRenderer.tsx#SlotRenderer"})}catch(__react_docgen_typescript_loader_error){}var Form_jsx=react.createElement;class Form extends react.Component{constructor(props){super(props),(0,defineProperty.c)(this,"getOnlyFormModifiedValues",(()=>{const formData=this.state.formData,fieldsModified=Object.keys((0,Utils.o1)(formData,this.state.initialFormData));return(0,objectSpread2.c)((0,objectSpread2.c)({},pickBy_default()(formData,((value,key)=>fieldsModified.includes(key)))),formData["@static_behaviors"]&&{"@static_behaviors":formData["@static_behaviors"]})})),(0,defineProperty.c)(this,"removeBlocksLayoutFields",(schema=>{const newSchema=(0,objectSpread2.c)({},schema),layoutFieldsetIndex=findIndex_default()(newSchema.fieldsets,(fieldset=>"layout"===fieldset.id));if(layoutFieldsetIndex>-1){const layoutFields=newSchema.fieldsets[layoutFieldsetIndex].fields;newSchema.fieldsets[layoutFieldsetIndex].fields=layoutFields.filter((field=>"blocks"!==field&&"blocks_layout"!==field)),0===newSchema.fieldsets[layoutFieldsetIndex].fields.length&&(newSchema.fieldsets=[...newSchema.fieldsets.slice(0,layoutFieldsetIndex),...newSchema.fieldsets.slice(layoutFieldsetIndex+1)])}return newSchema}));const ids={title:(0,v4.c)(),text:(0,v4.c)()};let{formData:_formData,schema:originalSchema}=props;const blocksFieldname=(0,Blocks.c$)(_formData),blocksLayoutFieldname=(0,Blocks.Ar)(_formData),_schema=this.removeBlocksLayoutFields(originalSchema);this.props.setMetadataFieldsets(null!=_schema&&_schema.fieldsets?_schema.fieldsets.map((fieldset=>fieldset.id)):[]),props.isEditForm||(_formData=(0,objectSpread2.c)((0,objectSpread2.c)({},mapValues_default()(props.schema.properties,"default")),_formData));const initialFormData=cloneDeep_default()(_formData);_formData.hasOwnProperty(blocksFieldname)&&_formData.hasOwnProperty(blocksLayoutFieldname)&&(_formData[blocksLayoutFieldname]&&!isEmpty_default()(_formData[blocksLayoutFieldname].items)||(_formData[blocksLayoutFieldname]={items:[ids.title,ids.text]}),_formData[blocksFieldname]&&!isEmpty_default()(_formData[blocksFieldname])||(_formData[blocksFieldname]={[ids.title]:{"@type":"title"},[ids.text]:{"@type":registry.default.settings.defaultBlockType}}));let selectedBlock=null;var _config$blocks,_config$blocks2;_formData.hasOwnProperty(blocksLayoutFieldname)&&_formData[blocksLayoutFieldname].items.length>0&&(null===(null===(_config$blocks=registry.default.blocks)||void 0===_config$blocks?void 0:_config$blocks.initialBlocksFocus)?selectedBlock=null:this.props.type in(null===(_config$blocks2=registry.default.blocks)||void 0===_config$blocks2?void 0:_config$blocks2.initialBlocksFocus)?Object.keys(_formData[blocksFieldname]).forEach((b_key=>{var _config$blocks3,_config$blocks3$initi;_formData[blocksFieldname][b_key]["@type"]===(null===(_config$blocks3=registry.default.blocks)||void 0===_config$blocks3||null===(_config$blocks3$initi=_config$blocks3.initialBlocksFocus)||void 0===_config$blocks3$initi?void 0:_config$blocks3$initi[this.props.type])&&(selectedBlock=b_key)})):selectedBlock=_formData[blocksLayoutFieldname].items[0]);this.props.global&&this.props.setFormData(_formData),this.props.setUIState({selected:selectedBlock,multiSelected:[],hovered:null}),this.state={formData:_formData,initialFormData:initialFormData,errors:{},isClient:!1,inFocus:{},sidebarMetadataIsAvailable:!1},this.onChangeField=this.onChangeField.bind(this),this.onSelectBlock=this.onSelectBlock.bind(this),this.onSubmit=this.onSubmit.bind(this),this.onCancel=this.onCancel.bind(this),this.onTabChange=this.onTabChange.bind(this),this.onBlurField=this.onBlurField.bind(this),this.onClickInput=this.onClickInput.bind(this),this.onToggleMetadataFieldset=this.onToggleMetadataFieldset.bind(this)}async componentDidUpdate(prevProps,prevState){let{requestError:requestError}=this.props,errors={},activeIndex=0;var _document$querySelect;(!this.props.isFormSelected&&prevProps.isFormSelected&&this.props.setUIState({selected:null}),requestError&&prevProps.requestError!==requestError&&(errors=FormValidation.cp.giveServerErrorsToCorrespondingFields(requestError),activeIndex=FormValidation.cp.showFirstTabWithErrors({errors:errors,schema:this.props.schema}),this.setState({errors:errors,activeIndex:activeIndex})),this.props.onChangeFormData&&(isEqual_default()(null==prevState?void 0:prevState.formData,this.state.formData)||this.props.onChangeFormData(this.state.formData)),this.props.global&&!isEqual_default()(this.props.globalData,prevProps.globalData)&&this.setState({formData:this.props.globalData}),isEqual_default()(prevProps.schema,this.props.schema)||this.props.setMetadataFieldsets(this.removeBlocksLayoutFields(this.props.schema).fieldsets.map((fieldset=>fieldset.id))),""===this.props.metadataFieldFocus||isEqual_default()(prevProps.metadataFieldFocus,this.props.metadataFieldFocus))||(document.querySelector(`.field-wrapper-${this.props.metadataFieldFocus}`).scrollIntoView(),null===(_document$querySelect=document.querySelector(`.field-wrapper-${this.props.metadataFieldFocus} input`))||void 0===_document$querySelect||_document$querySelect.focus(),this.props.resetMetadataFocus());!this.state.sidebarMetadataIsAvailable&&document.getElementById("sidebar-metadata")&&this.setState((()=>({sidebarMetadataIsAvailable:!0})))}onTabChange(e,{activeIndex:activeIndex}){const defaultFocus=this.props.schema.fieldsets[activeIndex].fields[0];this.setState((0,objectSpread2.c)({activeIndex:activeIndex},defaultFocus?{inFocus:{[defaultFocus]:!0}}:{}))}onClickInput(e){this.setState({isFormPristine:!1})}onBlurField(id,value){if(!this.state.isFormPristine){const errors=FormValidation.cp.validateFieldsPerFieldset({schema:this.props.schema,formData:this.state.formData,formatMessage:this.props.intl.formatMessage,touchedField:{[id]:value}});this.setState({errors:errors})}}componentDidMount(){this.setState({isClient:!0})}onChangeField(id,value){this.setState((prevState=>{const{errors:errors,formData:formData}=prevState,newFormData=(0,objectSpread2.c)((0,objectSpread2.c)({},formData),{},{[id]:value||void 0!==value&&isBoolean_default()(value)?value:null});return delete errors[id],this.props.global&&this.props.setFormData(newFormData),{errors:errors,formData:newFormData,inFocus:{[id]:!0}}}))}onSelectBlock(id,isMultipleSelection,event){let multiSelected=[],selected=id;const formData=this.state.formData;if(isMultipleSelection){selected=null;const blocks_layout=formData[(0,Blocks.Ar)(formData)].items;if(event.shiftKey){const anchor=this.props.uiState.multiSelected.length>0?blocks_layout.indexOf(this.props.uiState.multiSelected[0]):blocks_layout.indexOf(this.props.uiState.selected),focus=blocks_layout.indexOf(id);multiSelected=anchor===focus?[id]:focus>anchor?[...blocks_layout.slice(anchor,focus+1)]:[...blocks_layout.slice(focus,anchor+1)],window.getSelection().empty()}!event.ctrlKey&&!event.metaKey||event.shiftKey||(multiSelected=this.props.uiState.multiSelected||[],this.props.uiState.multiSelected.includes(this.state.selected)||(multiSelected=[...multiSelected,this.props.uiState.selected],selected=null),this.props.uiState.multiSelected.includes(id)?(selected=null,multiSelected=without_default()(multiSelected,id)):multiSelected=[...multiSelected,id])}this.props.setUIState({selected:selected,multiSelected:multiSelected,gridSelected:null}),this.props.onSelectForm&&(event&&event.nativeEvent.stopImmediatePropagation(),this.props.onSelectForm())}onCancel(event){event&&event.preventDefault(),(this.props.resetOnCancel||this.props.resetAfterSubmit)&&(this.setState({formData:this.props.formData}),this.props.global&&this.props.setFormData(this.props.formData)),this.props.onCancel(event)}onSubmit(event){const formData=this.state.formData;event&&event.preventDefault();const errors=this.props.schema?FormValidation.cp.validateFieldsPerFieldset({schema:this.props.schema,formData:formData,formatMessage:this.props.intl.formatMessage}):{};let blocksErrors={};if((0,Blocks.I1)(formData)){const blocks=this.state.formData[(0,Blocks.c$)(formData)],blocksLayout=this.state.formData[(0,Blocks.Ar)(formData)],defaultSchema={properties:{},fieldsets:[],required:[]};blocksLayout.items.forEach((block=>{let blockSchema=registry.default.blocks.blocksConfig[blocks[block]["@type"]].blockSchema||defaultSchema;"function"==typeof blockSchema&&(blockSchema=blockSchema({intl:this.props.intl,formData:blocks[block]})),registry.default.blocks.blocksConfig[blocks[block]["@type"]].blockSchema&&(blockSchema=(0,withBlockSchemaEnhancer.GI)({schema:blockSchema,formData:blocks[block],intl:this.props.intl,blocksConfig:registry.default.blocks.blocksConfig,navRoot:this.props.navRoot,contentType:this.props.content["@type"]}));const blockErrors=FormValidation.cp.validateFieldsPerFieldset({schema:blockSchema,formData:blocks[block],formatMessage:this.props.intl.formatMessage});keys_default()(blockErrors).length>0&&(blocksErrors=(0,objectSpread2.c)((0,objectSpread2.c)({},blocksErrors),{},{[block]:(0,objectSpread2.c)({},blockErrors)}))}))}if(keys_default()(errors).length>0||keys_default()(blocksErrors).length>0){const activeIndex=FormValidation.cp.showFirstTabWithErrors({errors:errors,schema:this.props.schema});if(this.setState({errors:(0,objectSpread2.c)((0,objectSpread2.c)({},errors),!isEmpty_default()(blocksErrors)&&{blocks:blocksErrors}),activeIndex:activeIndex}),keys_default()(errors).length>0)Object.keys(errors).forEach((err=>react_toastify.toast.error(Form_jsx(Toast.c,{error:!0,title:this.props.schema.properties[err].title||err,content:errors[err].join(", ")})))),this.props.setSidebarTab(0);else if(keys_default()(blocksErrors).length>0){const errorField=Object.entries(Object.entries(blocksErrors)[0][1])[0][0],errorMessage=Object.entries(Object.entries(blocksErrors)[0][1])[0][1],errorFieldTitle=errorMessage.title||errorField;react_toastify.toast.error(Form_jsx(Toast.c,{error:!0,title:this.props.intl.formatMessage(MessageLabels.c.blocksFieldsErrorTitle,{errorField:errorFieldTitle}),content:errorMessage})),this.props.setSidebarTab(1),this.props.setUIState({selected:Object.keys(blocksErrors)[0],multiSelected:[],hovered:null})}}else this.props.isEditForm?this.props.onSubmit(this.getOnlyFormModifiedValues()):this.props.onSubmit(formData),this.props.resetAfterSubmit&&(this.setState({formData:this.props.formData}),this.props.global&&this.props.setFormData(this.props.formData))}onToggleMetadataFieldset(event,blockProps){const{index:index}=blockProps;this.props.setMetadataFieldsets(xor_default()(this.props.metadataFieldsets,[index]))}render(){const{settings:settings}=registry.default,{schema:originalSchema,onCancel:onCancel,onSubmit:onSubmit,navRoot:navRoot,type:type,metadataFieldsets:metadataFieldsets,component:component,buttonComponent:buttonComponent}=this.props,formData=this.state.formData,schema=this.removeBlocksLayoutFields(originalSchema),Container=registry.default.getComponent({name:"Container"}).component||Container_Container.c,FormComponent=component||Form_Form.c,ButtonComponent=buttonComponent||Button.c;return this.props.visual?this.state.isClient&&Form_jsx(react.Fragment,null,Form_jsx(SlotRenderer_SlotRenderer,{name:"aboveContent",content:this.props.content,navRoot:navRoot}),Form_jsx(Container,null,Form_jsx(react.Fragment,null,Form_jsx(BlocksToolbar.default,{formData:formData,selectedBlock:this.props.uiState.selected,selectedBlocks:this.props.uiState.multiSelected,onChangeBlocks:newBlockData=>{const newFormData=(0,objectSpread2.c)((0,objectSpread2.c)({},formData),newBlockData);this.setState({formData:newFormData}),this.props.global&&this.props.setFormData(newFormData)},onSetSelectedBlocks:blockIds=>this.props.setUIState({multiSelected:blockIds}),onSelectBlock:this.onSelectBlock}),Form_jsx(UndoToolbar.default,{state:{formData:formData,selected:this.props.uiState.selected,multiSelected:this.props.uiState.multiSelected},enableHotKeys:!0,onUndoRedo:({state:state})=>(this.props.global&&this.props.setFormData(state.formData),this.setState(state))}),Form_jsx(manage_Form.P7,{onChangeFormData:newData=>{const newFormData=(0,objectSpread2.c)((0,objectSpread2.c)({},formData),newData);this.setState({formData:newFormData}),this.props.global&&this.props.setFormData(newFormData)},onChangeField:this.onChangeField,onSelectBlock:this.onSelectBlock,properties:formData,navRoot:navRoot,type:type,pathname:this.props.pathname,selectedBlock:this.props.uiState.selected,multiSelected:this.props.uiState.multiSelected,manage:this.props.isAdminForm,allowedBlocks:this.props.allowedBlocks,showRestricted:this.props.showRestricted,editable:this.props.editable,isMainForm:this.props.editable,history:this.props.history,location:this.props.location,token:this.props.token,errors:this.state.errors,blocksErrors:this.state.errors.blocks}),this.state.isClient&&this.state.sidebarMetadataIsAvailable&&this.props.editable&&(0,react_dom.createPortal)(Form_jsx(Form_Form.c,{method:"post",onSubmit:this.onSubmit,error:keys_default()(this.state.errors).length>0},schema&&map_default()(schema.fieldsets,(fieldset=>Form_jsx(Accordion.c,{fluid:!0,styled:!0,className:"form",key:fieldset.title},Form_jsx("div",{key:fieldset.id,id:`metadataform-fieldset-${fieldset.id}`},Form_jsx(Accordion.c.Title,{active:metadataFieldsets.includes(fieldset.id),index:fieldset.id,onClick:this.onToggleMetadataFieldset},fieldset.title,metadataFieldsets.includes(fieldset.id)?Form_jsx(Icon.c,{name:up_key_default(),size:"20px"}):Form_jsx(Icon.c,{name:down_key_default(),size:"20px"})),Form_jsx(Accordion.c.Content,{active:metadataFieldsets.includes(fieldset.id)},Form_jsx(Segment.c,{className:"attached"},map_default()(fieldset.fields,((field,index)=>{var _document$getElementB;return Form_jsx(manage_Form.IN,(0,esm_extends.c)({},schema.properties[field],{id:field,fieldSet:fieldset.title.toLowerCase(),formData:formData,focus:!(!this.state.isClient||null===(_document$getElementB=document.getElementById("sidebar-metadata"))||void 0===_document$getElementB||!_document$getElementB.contains(document.activeElement))&&this.state.inFocus[field],value:null==formData?void 0:formData[field],required:-1!==schema.required.indexOf(field),onChange:this.onChangeField,onBlur:this.onBlurField,onClick:this.onClickInput,key:field,error:this.state.errors[field]}))}))))))))),document.getElementById("sidebar-metadata")),Form_jsx(SlotRenderer_SlotRenderer,{name:"belowContent",content:this.props.content,navRoot:navRoot})))):Form_jsx(Container,null,Form_jsx(FormComponent,{method:"post",onSubmit:this.onSubmit,error:keys_default()(this.state.errors).length>0,className:settings.verticalFormTabs?"vertical-form":""},Form_jsx("fieldset",{className:"invisible"},Form_jsx(Segment.c.Group,{raised:!0},schema&&schema.fieldsets.length>1&&Form_jsx(react.Fragment,null,settings.verticalFormTabs&&this.props.title&&Form_jsx(Segment.c,{secondary:!0,attached:!0,key:this.props.title},this.props.title),Form_jsx(Tab.c,{menu:{secondary:!0,pointing:!0,attached:!0,tabular:!0,className:"formtabs",vertical:settings.verticalFormTabs},grid:{paneWidth:9,tabWidth:3,stackable:!0},onTabChange:this.onTabChange,activeIndex:this.state.activeIndex,panes:map_default()(schema.fieldsets,(item=>({menuItem:item.title,render:()=>[!settings.verticalFormTabs&&this.props.title&&Form_jsx(Segment.c,{secondary:!0,attached:!0,key:this.props.title},this.props.title),item.description&&Form_jsx(Message.c,{attached:"bottom"},item.description),...map_default()(item.fields,((field,index)=>Form_jsx(manage_Form.IN,(0,esm_extends.c)({widgets:this.props.widgets},schema.properties[field],{id:field,formData:formData,fieldSet:item.id,focus:this.state.inFocus[field],value:null==formData?void 0:formData[field],required:-1!==schema.required.indexOf(field),onChange:this.props.editable?this.onChangeField:()=>{},onBlur:this.onBlurField,onClick:this.onClickInput,key:field,error:this.state.errors[field]}))))]})))})),schema&&1===schema.fieldsets.length&&Form_jsx(Segment.c,null,this.props.title&&Form_jsx(Segment.c,{className:"primary"},Form_jsx("h1",{style:{fontSize:"16px"}}," ",this.props.title)),this.props.description&&Form_jsx(Segment.c,{secondary:!0},this.props.description),keys_default()(this.state.errors).length>0&&Form_jsx(Message.c,{icon:"warning",negative:!0,attached:!0,header:this.props.intl.formatMessage(MessageLabels.c.error),content:this.props.intl.formatMessage(MessageLabels.c.thereWereSomeErrors)}),this.props.error&&Form_jsx(Message.c,{icon:"warning",negative:!0,attached:!0,header:this.props.intl.formatMessage(MessageLabels.c.error),content:this.props.error.message}),map_default()(schema.fieldsets[0].fields,(field=>Form_jsx(manage_Form.IN,(0,esm_extends.c)({widgets:this.props.widgets},schema.properties[field],{id:field,value:null==formData?void 0:formData[field],required:-1!==schema.required.indexOf(field),onChange:this.onChangeField,onBlur:this.onBlurField,onClick:this.onClickInput,key:field,error:this.state.errors[field]}))))),!this.props.hideActions&&Form_jsx(Segment.c,{className:"actions",clearing:!0},onSubmit&&(this.props.textButtons?Form_jsx(ButtonComponent,{primary:!0,floated:"right",type:"submit","aria-label":this.props.submitLabel?this.props.submitLabel:this.props.intl.formatMessage(MessageLabels.c.save),title:this.props.submitLabel?this.props.submitLabel:this.props.intl.formatMessage(MessageLabels.c.save),loading:this.props.loading},this.props.submitLabel?this.props.submitLabel:this.props.intl.formatMessage(MessageLabels.c.save)):Form_jsx(ButtonComponent,{basic:!0,primary:!0,floated:"right",type:"submit","aria-label":this.props.submitLabel?this.props.submitLabel:this.props.intl.formatMessage(MessageLabels.c.save),title:this.props.submitLabel?this.props.submitLabel:this.props.intl.formatMessage(MessageLabels.c.save),loading:this.props.loading},Form_jsx(Icon.c,{className:"circled",name:ahead_default(),size:"30px"}))),onCancel&&(this.props.textButtons?Form_jsx(ButtonComponent,{secondary:!0,type:"button","aria-label":this.props.cancelLabel?this.props.cancelLabel:this.props.intl.formatMessage(MessageLabels.c.cancel),title:this.props.cancelLabel?this.props.cancelLabel:this.props.intl.formatMessage(MessageLabels.c.cancel),floated:"right",onClick:this.onCancel},this.props.cancelLabel?this.props.cancelLabel:this.props.intl.formatMessage(MessageLabels.c.cancel)):Form_jsx(ButtonComponent,{basic:!0,secondary:!0,type:"button","aria-label":this.props.cancelLabel?this.props.cancelLabel:this.props.intl.formatMessage(MessageLabels.c.cancel),title:this.props.cancelLabel?this.props.cancelLabel:this.props.intl.formatMessage(MessageLabels.c.cancel),floated:"right",onClick:this.onCancel},Form_jsx(Icon.c,{className:"circled",name:clear_default(),size:"30px"}))))))))}}(0,defineProperty.c)(Form,"defaultProps",{formData:null,widgets:null,component:null,onSubmit:null,onCancel:null,submitLabel:null,cancelLabel:null,textButtons:!1,buttonComponent:null,resetAfterSubmit:!1,resetOnCancel:!1,isEditForm:!1,isAdminForm:!1,title:null,description:null,error:null,loading:null,hideActions:!1,visual:!1,blocks:[],pathname:"",schema:{},isFormSelected:!0,onSelectForm:null,editable:!0,requestError:null,allowedBlocks:null,global:!1});const FormIntl=(0,injectIntl.cp)(Form,{forwardRef:!0});var manage_Form_Form=(0,redux.compose)((0,es.connect)(((state,props)=>{var _state$form,_state$form2,_state$sidebar,_state$sidebar2;return{content:state.content.data,globalData:null===(_state$form=state.form)||void 0===_state$form?void 0:_state$form.global,uiState:null===(_state$form2=state.form)||void 0===_state$form2?void 0:_state$form2.ui,metadataFieldsets:null===(_state$sidebar=state.sidebar)||void 0===_state$sidebar?void 0:_state$sidebar.metadataFieldsets,metadataFieldFocus:null===(_state$sidebar2=state.sidebar)||void 0===_state$sidebar2?void 0:_state$sidebar2.metadataFieldFocus}}),{setMetadataFieldsets:sidebar.gh,setSidebarTab:sidebar.Of,setFormData:form_form.I,setUIState:form_form.i,resetMetadataFocus:sidebar.IZ},null,{forwardRef:!0}))(FormIntl);Form.__docgenInfo={description:"Form container class.\n@class Form\n@extends Component",methods:[{name:"onTabChange",docblock:"Tab selection is done only by setting activeIndex in state",modifiers:[],params:[{name:"e",optional:!1},{name:"{ activeIndex }",optional:!1}],returns:null,description:"Tab selection is done only by setting activeIndex in state"},{name:"onClickInput",docblock:"If user clicks on input, the form will be not considered pristine\nthis will avoid onBlur effects without interaction with the form\n@param {Object} e event",modifiers:[],params:[{name:"e",description:"event",type:{name:"Object"},optional:!1}],returns:null,description:"If user clicks on input, the form will be not considered pristine\nthis will avoid onBlur effects without interaction with the form"},{name:"onBlurField",docblock:"Validate fields on blur\n@method onBlurField\n@param {string} id Id of the field\n@param {*} value Value of the field\n@returns {undefined}",modifiers:[],params:[{name:"id",description:"Id of the field",type:{name:"string"},optional:!1},{name:"value",description:"Value of the field",type:{name:"mixed"},optional:!1}],returns:{},description:"Validate fields on blur"},{name:"onChangeField",docblock:"Change field handler\nRemove errors for changed field\n@method onChangeField\n@param {string} id Id of the field\n@param {*} value Value of the field\n@returns {undefined}",modifiers:[],params:[{name:"id",description:"Id of the field",type:{name:"string"},optional:!1},{name:"value",description:"Value of the field",type:{name:"mixed"},optional:!1}],returns:{},description:"Change field handler\nRemove errors for changed field"},{name:"onSelectBlock",docblock:"Select block handler\n@method onSelectBlock\n@param {string} id Id of the field\n@param {string} isMultipleSelection true if multiple blocks are selected\n@returns {undefined}",modifiers:[],params:[{name:"id",description:"Id of the field",type:{name:"string"},optional:!1},{name:"isMultipleSelection",description:"true if multiple blocks are selected",type:{name:"string"},optional:!1},{name:"event",optional:!1}],returns:{},description:"Select block handler"},{name:"onCancel",docblock:"Cancel handler\nIt prevents event from triggering submit, reset form if props.resetAfterSubmit\nand calls this.props.onCancel\n@method onCancel\n@param {Object} event Event object.\n@returns {undefined}",modifiers:[],params:[{name:"event",description:"Event object.",type:{name:"Object"},optional:!1}],returns:{},description:"Cancel handler\nIt prevents event from triggering submit, reset form if props.resetAfterSubmit\nand calls this.props.onCancel"},{name:"onSubmit",docblock:"Submit handler also validate form and collect errors\n@method onSubmit\n@param {Object} event Event object.\n@returns {undefined}",modifiers:[],params:[{name:"event",description:"Event object.",type:{name:"Object"},optional:!1}],returns:{},description:"Submit handler also validate form and collect errors"},{name:"getOnlyFormModifiedValues",docblock:"getOnlyFormModifiedValues handler\nIt returns only the values of the fields that are have really changed since the\nform was loaded. Useful for edit forms and PATCH operations, when we only want to\nsend the changed data.\n@method getOnlyFormModifiedValues\n@param {Object} event Event object.\n@returns {undefined}",modifiers:[],params:[],returns:{},description:"getOnlyFormModifiedValues handler\nIt returns only the values of the fields that are have really changed since the\nform was loaded. Useful for edit forms and PATCH operations, when we only want to\nsend the changed data."},{name:"removeBlocksLayoutFields",docblock:"Removed blocks and blocks_layout fields from the form.\n@method removeBlocksLayoutFields\n@param {object} schema The schema definition of the form.\n@returns A modified copy of the given schema.",modifiers:[],params:[{name:"schema",description:"The schema definition of the form.",type:{name:"object"},optional:!1}],returns:{description:"A modified copy of the given schema."},description:"Removed blocks and blocks_layout fields from the form."},{name:"onToggleMetadataFieldset",docblock:"Toggle metadata fieldset handler\n@method onToggleMetadataFieldset\n@param {Object} event Event object.\n@param {Object} blockProps Block properties.\n@returns {undefined}",modifiers:[],params:[{name:"event",description:"Event object.",type:{name:"Object"},optional:!1},{name:"blockProps",description:"Block properties.",type:{name:"Object"},optional:!1}],returns:{},description:"Toggle metadata fieldset handler"}],displayName:"Form",props:{formData:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"objectOf",value:{name:"any"}},required:!1},widgets:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"objectOf",value:{name:"any"}},required:!1},component:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"any"},required:!1},onSubmit:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},onCancel:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},submitLabel:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},cancelLabel:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},textButtons:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},buttonComponent:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"any"},required:!1},resetAfterSubmit:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},resetOnCancel:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},isEditForm:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},isAdminForm:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},title:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},description:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},error:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"shape",value:{message:{name:"string",required:!1}}},required:!1},loading:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"bool"},required:!1},hideActions:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},visual:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},blocks:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"object"}},required:!1},pathname:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},schema:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{fieldsets:{name:"arrayOf",value:{name:"shape",value:{fields:{name:"arrayOf",value:{name:"string"},required:!1},id:{name:"string",required:!1},title:{name:"string",required:!1}}},required:!1},properties:{name:"objectOf",value:{name:"any"},required:!1},definitions:{name:"objectOf",value:{name:"any"},required:!1},required:{name:"arrayOf",value:{name:"string"},required:!1}}},required:!1},isFormSelected:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},onSelectForm:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},editable:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},requestError:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},allowedBlocks:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},global:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},globalData:{description:"",type:{name:"objectOf",value:{name:"any"}},required:!1},metadataFieldsets:{description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},metadataFieldFocus:{description:"",type:{name:"string"},required:!1},onChangeFormData:{description:"",type:{name:"func"},required:!1},showRestricted:{description:"",type:{name:"bool"},required:!1}}}},"./src/components/manage/Form/InlineForm.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return Form_InlineForm}});var esm_extends=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),Segment=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Segment/Segment.js"),Message=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/collections/Message/Message.js"),Accordion=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/modules/Accordion/Accordion.js"),lib=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/index.js"),injectIntl=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/injectIntl.js"),AnimateHeight=__webpack_require__("../../../node_modules/.pnpm/react-animate-height@2.0.17_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/react-animate-height/lib/AnimateHeight.js"),keys=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/keys.js"),keys_default=__webpack_require__.n(keys),map=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/map.js"),map_default=__webpack_require__.n(map),isEqual=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEqual.js"),isEqual_default=__webpack_require__.n(isEqual),esm_react=__webpack_require__("../../../node_modules/.pnpm/jotai@2.11.3_@types+react@18.3.20_react@18.2.0/node_modules/jotai/esm/react.mjs"),vanilla=__webpack_require__("../../../node_modules/.pnpm/jotai@2.11.3_@types+react@18.3.20_react@18.2.0/node_modules/jotai/esm/vanilla.mjs");const inlineFormFieldsetsState=(0,__webpack_require__("../../../node_modules/.pnpm/jotai@2.11.3_@types+react@18.3.20_react@18.2.0/node_modules/jotai/esm/vanilla/utils.mjs").KU)((({name:name,initialState:initialState})=>(0,vanilla.Zf)(initialState)),((a,b)=>a.name===b.name&&isEqual_default()(a.fielsetList,b.fielsetList)));var Utils=__webpack_require__("./src/helpers/Utils/Utils.jsx"),Icon=__webpack_require__("./src/components/theme/Icon/Icon.jsx"),Form=__webpack_require__("./src/components/manage/Form/index.tsx"),Blocks=__webpack_require__("./src/helpers/Blocks/Blocks.js"),up_key=__webpack_require__("./src/icons/up-key.svg"),up_key_default=__webpack_require__.n(up_key),down_key=__webpack_require__("./src/icons/down-key.svg"),down_key_default=__webpack_require__.n(down_key),registry=__webpack_require__("./src/registry.js"),__jsx=react.createElement;const messages=(0,lib.defineMessages)({editValues:{id:"Edit values",defaultMessage:"Edit values"},error:{id:"Error",defaultMessage:"Error"},thereWereSomeErrors:{id:"There were some errors",defaultMessage:"There were some errors"}}),InlineForm=props=>{const{block:block,description:description,error:error,errors:errors={},formData:formData,onChangeFormData:onChangeFormData,onChangeField:onChangeField,schema:schema,title:title,icon:icon,headerActions:headerActions,actionButton:actionButton,footer:footer,focusIndex:focusIndex,intl:intl}=props,_=intl.formatMessage,defaultFieldset=schema.fieldsets.find((o=>"default"===o.id)),other=schema.fieldsets.filter((o=>"default"!==o.id));react.useEffect((()=>{const objectSchema="function"==typeof schema?schema(props):schema,initialData=(0,Blocks.M3)({data:formData,schema:objectSchema,intl:intl});onChangeFormData?onChangeFormData(initialData):Object.keys(initialData).forEach((k=>{isEqual_default()(initialData[k],null==formData?void 0:formData[k])||onChangeField(k,initialData[k])}))}),[]);const[currentActiveFieldset,setCurrentActiveFieldset]=(0,esm_react.lZ)(inlineFormFieldsetsState({name:block,fielsetList:other,initialState:registry.default.settings.blockSettingsTabFieldsetsInitialStateOpen?(0,Utils.kt)(0,other.length-1,1):[]}));function handleCurrentActiveFieldset(e,blockProps){const{index:index}=blockProps;currentActiveFieldset.includes(index)?setCurrentActiveFieldset((0,Utils.ye)(currentActiveFieldset,currentActiveFieldset.indexOf(index))):setCurrentActiveFieldset((0,Utils.wL)(currentActiveFieldset,index,currentActiveFieldset.length+1))}return __jsx("div",{className:"ui form"},title&&__jsx("header",{className:"header pulled"},icon,__jsx("h2",null,title||_(messages.editValues)),headerActions),description&&__jsx(Segment.c,{secondary:!0,className:"attached"},description),keys_default()(errors).length>0&&__jsx(Message.c,{icon:"warning",negative:!0,attached:!0,header:_(messages.error),content:_(messages.thereWereSomeErrors)}),error&&__jsx(Message.c,{icon:"warning",negative:!0,attached:!0,header:_(messages.error),content:error.message}),__jsx("div",{id:`blockform-fieldset-${defaultFieldset.id}`},__jsx(Segment.c,{className:"form attached"},map_default()(defaultFieldset.fields,((field,index)=>{var _errors$block;return __jsx(Form.IN,(0,esm_extends.c)({},schema.properties[field],{id:field,fieldSet:defaultFieldset.title.toLowerCase(),focus:index===focusIndex,value:formData[field],required:-1!==schema.required.indexOf(field),onChange:(id,value,itemInfo)=>{onChangeField(id,value,itemInfo)},key:field,error:(null==errors||null===(_errors$block=errors[block])||void 0===_errors$block?void 0:_errors$block[field])||{},block:block}))})),actionButton&&__jsx(Segment.c,{className:"attached actions"},actionButton))),other.map(((fieldset,index)=>__jsx(Accordion.c,{fluid:!0,styled:!0,className:"form",key:fieldset.id},__jsx("div",{key:fieldset.id,id:`blockform-fieldset-${fieldset.id}`},__jsx(Accordion.c.Title,{active:currentActiveFieldset.includes(index),index:index,onClick:handleCurrentActiveFieldset},fieldset.title&&__jsx(react.Fragment,null,fieldset.title),currentActiveFieldset.includes(index)?__jsx(Icon.c,{name:up_key_default(),size:"20px"}):__jsx(Icon.c,{name:down_key_default(),size:"20px"})),__jsx(Accordion.c.Content,{active:currentActiveFieldset.includes(index)},__jsx(AnimateHeight.c,{animateOpacity:!0,duration:500,height:currentActiveFieldset.includes(index)?"auto":0},__jsx(Segment.c,{className:"attached"},map_default()(fieldset.fields,(field=>{var _errors$block2;return __jsx(Form.IN,(0,esm_extends.c)({},schema.properties[field],{id:field,value:formData[field],required:-1!==schema.required.indexOf(field),onChange:(id,value)=>{onChangeField(id,value)},key:field,error:(null==errors||null===(_errors$block2=errors[block])||void 0===_errors$block2?void 0:_errors$block2[field])||{},block:block}))}))))))))),footer)};InlineForm.defaultProps={block:null,description:null,formData:null,onChangeField:null,error:null,errors:{},schema:{},focusIndex:null};var Form_InlineForm=(0,injectIntl.cp)(InlineForm,{forwardRef:!0});InlineForm.__docgenInfo={description:"",methods:[],displayName:"InlineForm",props:{block:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},description:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},formData:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"objectOf",value:{name:"any"}},required:!1},onChangeField:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},error:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"shape",value:{message:{name:"string",required:!1}}},required:!1},errors:{defaultValue:{value:"{}",computed:!1},required:!1},schema:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{fieldsets:{name:"arrayOf",value:{name:"shape",value:{fields:{name:"arrayOf",value:{name:"string"},required:!1},id:{name:"string",required:!1},title:{name:"string",required:!1}}},required:!1},properties:{name:"objectOf",value:{name:"any"},required:!1},definitions:{name:"objectOf",value:{name:"any"},required:!1},required:{name:"arrayOf",value:{name:"string"},required:!1}}},required:!1},focusIndex:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"number"},required:!1},pathname:{description:"",type:{name:"string"},required:!1}}}},"./src/components/manage/Form/ModalForm.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/extends.js"),_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),lodash_isEqual__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEqual.js"),lodash_isEqual__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_isEqual__WEBPACK_IMPORTED_MODULE_1__),lodash_keys__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/keys.js"),lodash_keys__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash_keys__WEBPACK_IMPORTED_MODULE_2__),lodash_map__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/map.js"),lodash_map__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(lodash_map__WEBPACK_IMPORTED_MODULE_3__),semantic_ui_react__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/modules/Modal/Modal.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Header/Header.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/modules/Dimmer/Dimmer.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Loader/Loader.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/collections/Form/Form.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/collections/Message/Message.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/collections/Menu/Menu.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Button/Button.js"),react_intl__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/index.js"),react_intl__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/message.js"),react_intl__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/injectIntl.js"),_plone_volto_helpers_FormValidation_FormValidation__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/helpers/FormValidation/FormValidation.jsx"),_plone_volto_components_theme_Icon_Icon__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/theme/Icon/Icon.jsx"),_plone_volto_components_manage_Form__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/components/manage/Form/index.tsx"),_plone_volto_icons_ahead_svg__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/icons/ahead.svg"),_plone_volto_icons_ahead_svg__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_plone_volto_icons_ahead_svg__WEBPACK_IMPORTED_MODULE_7__),_plone_volto_icons_clear_svg__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/icons/clear.svg"),_plone_volto_icons_clear_svg__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_plone_volto_icons_clear_svg__WEBPACK_IMPORTED_MODULE_8__),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;const messages=(0,react_intl__WEBPACK_IMPORTED_MODULE_9__.defineMessages)({required:{id:"Required input is missing.",defaultMessage:"Required input is missing."},minLength:{id:"Minimum length is {len}.",defaultMessage:"Minimum length is {len}."},uniqueItems:{id:"Items must be unique.",defaultMessage:"Items must be unique."},save:{id:"Save",defaultMessage:"Save"},cancel:{id:"Cancel",defaultMessage:"Cancel"}});class ModalForm extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state={currentTab:0,errors:{},isFormPristine:!0,formData:props.formData},this.selectTab=this.selectTab.bind(this),this.onChangeField=this.onChangeField.bind(this),this.onBlurField=this.onBlurField.bind(this),this.onClickInput=this.onClickInput.bind(this),this.onSubmit=this.onSubmit.bind(this)}onChangeField(id,value){this.setState({formData:(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.c)((0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.c)({},this.state.formData),{},{[id]:value})})}onClickInput(e){this.setState({isFormPristine:!1})}onBlurField(id,value){if(!this.state.isFormPristine){const errors=_plone_volto_helpers_FormValidation_FormValidation__WEBPACK_IMPORTED_MODULE_4__.cp.validateFieldsPerFieldset({schema:this.props.schema,formData:this.state.formData,formatMessage:this.props.intl.formatMessage,touchedField:{[id]:value}});this.setState({errors:errors})}}onSubmit(event){event.preventDefault();const errors=_plone_volto_helpers_FormValidation_FormValidation__WEBPACK_IMPORTED_MODULE_4__.cp.validateFieldsPerFieldset({schema:this.props.schema,formData:this.state.formData,formatMessage:this.props.intl.formatMessage});if(lodash_keys__WEBPACK_IMPORTED_MODULE_2___default()(errors).length>0)this.setState({errors:errors});else{let setFormDataCallback=formData=>{this.setState({formData:formData,errors:{}})};this.props.onSubmit(this.state.formData,setFormDataCallback)}}selectTab(event,{index:index}){this.setState({currentTab:index})}async componentDidUpdate(prevProps,prevState){if(this.props.onChangeFormData&&(lodash_isEqual__WEBPACK_IMPORTED_MODULE_1___default()(null==prevState?void 0:prevState.formData,this.state.formData)||this.props.onChangeFormData(this.state.formData)),!lodash_isEqual__WEBPACK_IMPORTED_MODULE_1___default()(prevProps.formData,this.props.formData)){let newFormData={};lodash_map__WEBPACK_IMPORTED_MODULE_3___default()(lodash_keys__WEBPACK_IMPORTED_MODULE_2___default()(this.props.formData),(field=>{lodash_isEqual__WEBPACK_IMPORTED_MODULE_1___default()(prevProps.formData[field],this.props.formData[field])||(newFormData[field]=this.props.formData[field])})),this.setState({formData:(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.c)((0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.c)({},this.state.formData),newFormData)})}}render(){const{schema:schema,onCancel:onCancel,description:description}=this.props,currentFieldset=schema.fieldsets[this.state.currentTab],fields=lodash_map__WEBPACK_IMPORTED_MODULE_3___default()(currentFieldset.fields,(field=>(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.c)((0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.c)({},schema.properties[field]),{},{id:field,value:this.state.formData[field],required:-1!==schema.required.indexOf(field),onChange:this.onChangeField,onBlur:this.onBlurField,onClick:this.onClickInput}))),state_errors=lodash_keys__WEBPACK_IMPORTED_MODULE_2___default()(this.state.errors).length>0;return __jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_11__.c,{dimmer:this.props.dimmer,open:this.props.open,className:this.props.className},__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_12__.c,null,this.props.title),__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_13__.c,{active:this.props.loading},__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_14__.c,null,this.props.loadingMessage||__jsx(react_intl__WEBPACK_IMPORTED_MODULE_15__.c,{id:"Loading",defaultMessage:"Loading."}))),__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_11__.c.Content,{scrolling:!0},__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_16__.c,{method:"post",onSubmit:this.onSubmit,error:state_errors||Boolean(this.props.submitError)},description,__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_17__.c,{error:!0},state_errors?__jsx(react_intl__WEBPACK_IMPORTED_MODULE_15__.c,{id:"There were some errors.",defaultMessage:"There were some errors."}):"",__jsx("div",null,this.props.submitError)),schema.fieldsets.length>1&&__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_18__.c,{tabular:!0,stackable:!0},lodash_map__WEBPACK_IMPORTED_MODULE_3___default()(schema.fieldsets,((item,index)=>__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_18__.c.Item,{name:item.id,index:index,key:item.id,active:this.state.currentTab===index,onClick:this.selectTab},item.title)))),fields.map((field=>__jsx(_plone_volto_components_manage_Form__WEBPACK_IMPORTED_MODULE_6__.IN,(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_19__.c)({},field,{key:field.id,onBlur:this.onBlurField,onClick:this.onClickInput,error:this.state.errors[field.id]})))))),__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_11__.c.Actions,null,__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_20__.c,{basic:!0,circular:!0,primary:!0,floated:"right","aria-label":this.props.submitLabel?this.props.submitLabel:this.props.intl.formatMessage(messages.save),title:this.props.submitLabel?this.props.submitLabel:this.props.intl.formatMessage(messages.save),onClick:this.onSubmit,loading:this.props.loading},__jsx(_plone_volto_components_theme_Icon_Icon__WEBPACK_IMPORTED_MODULE_5__.c,{name:_plone_volto_icons_ahead_svg__WEBPACK_IMPORTED_MODULE_7___default(),className:"contents circled",size:"30px"})),onCancel&&__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_20__.c,{type:"button",basic:!0,circular:!0,secondary:!0,"aria-label":this.props.intl.formatMessage(messages.cancel),title:this.props.intl.formatMessage(messages.cancel),floated:"right",onClick:onCancel},__jsx(_plone_volto_components_theme_Icon_Icon__WEBPACK_IMPORTED_MODULE_5__.c,{name:_plone_volto_icons_clear_svg__WEBPACK_IMPORTED_MODULE_8___default(),className:"circled",size:"30px"}))))}}(0,_home_runner_work_volto_authomatic_volto_authomatic_node_modules_pnpm_babel_runtime_7_20_6_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_21__.c)(ModalForm,"defaultProps",{submitLabel:null,onCancel:null,formData:{},open:!0,loading:null,loadingMessage:null,submitError:null,className:null,dimmer:null}),__webpack_exports__.default=(0,react_intl__WEBPACK_IMPORTED_MODULE_22__.cp)(ModalForm),ModalForm.__docgenInfo={description:"Modal form container class.\n@class ModalForm\n@extends Component",methods:[{name:"onChangeField",docblock:"Change field handler\n@method onChangeField\n@param {string} id Id of the field\n@param {*} value Value of the field\n@returns {undefined}",modifiers:[],params:[{name:"id",description:"Id of the field",type:{name:"string"},optional:!1},{name:"value",description:"Value of the field",type:{name:"mixed"},optional:!1}],returns:{},description:"Change field handler"},{name:"onClickInput",docblock:"If user clicks on input, the form will be not considered pristine\nthis will avoid onBlur effects without interaction with the form\n@param {Object} e event",modifiers:[],params:[{name:"e",description:"event",type:{name:"Object"},optional:!1}],returns:null,description:"If user clicks on input, the form will be not considered pristine\nthis will avoid onBlur effects without interaction with the form"},{name:"onBlurField",docblock:"Validate fields on blur\n@method onBlurField\n@param {string} id Id of the field\n@param {*} value Value of the field\n@returns {undefined}",modifiers:[],params:[{name:"id",description:"Id of the field",type:{name:"string"},optional:!1},{name:"value",description:"Value of the field",type:{name:"mixed"},optional:!1}],returns:{},description:"Validate fields on blur"},{name:"onSubmit",docblock:"Submit handler\n@method onSubmit\n@param {Object} event Event object.\n@returns {undefined}",modifiers:[],params:[{name:"event",description:"Event object.",type:{name:"Object"},optional:!1}],returns:{},description:"Submit handler"},{name:"selectTab",docblock:"Select tab handler\n@method selectTab\n@param {Object} event Event object.\n@param {number} index Selected tab index.\n@returns {undefined}",modifiers:[],params:[{name:"event",description:"Event object.",type:{name:"Object"},optional:!1},{name:"{ index }",optional:!1}],returns:{},description:"Select tab handler"}],displayName:"ModalForm",props:{submitLabel:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},onCancel:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},formData:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"any"}},required:!1},open:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},loading:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"bool"},required:!1},loadingMessage:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},submitError:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},className:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},dimmer:{defaultValue:{value:"null",computed:!1},required:!1},schema:{description:"",type:{name:"shape",value:{fieldsets:{name:"arrayOf",value:{name:"shape",value:{fields:{name:"arrayOf",value:{name:"string"},required:!1},id:{name:"string",required:!1},title:{name:"string",required:!1}}},required:!1},properties:{name:"objectOf",value:{name:"any"},required:!1},required:{name:"arrayOf",value:{name:"string"},required:!1}}},required:!0},title:{description:"",type:{name:"string"},required:!0},description:{description:"",type:{name:"objectOf",value:{name:"any"}},required:!1},onSubmit:{description:"",type:{name:"func"},required:!0},onChangeFormData:{description:"",type:{name:"func"},required:!1}}}},"./src/components/manage/Form/UndoToolbar.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),react_intl__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/index.js"),react_intl__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/useIntl.js"),_plone_volto_components_manage_Pluggable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/manage/Pluggable/index.js"),_plone_volto_components_theme_Icon_Icon__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/theme/Icon/Icon.jsx"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Button/Button.js"),_plone_volto_helpers_UndoManager_useUndoManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/helpers/UndoManager/useUndoManager.js"),_plone_volto_registry__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/registry.js"),_plone_volto_icons_undo_svg__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/icons/undo.svg"),_plone_volto_icons_undo_svg__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_plone_volto_icons_undo_svg__WEBPACK_IMPORTED_MODULE_5__),_plone_volto_icons_redo_svg__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/icons/redo.svg"),_plone_volto_icons_redo_svg__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_plone_volto_icons_redo_svg__WEBPACK_IMPORTED_MODULE_6__),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;const messages=(0,react_intl__WEBPACK_IMPORTED_MODULE_7__.defineMessages)({undo:{id:"Undo",defaultMessage:"Undo"},redo:{id:"Redo",defaultMessage:"Redo"}}),UndoToolbar=({state:state,onUndoRedo:onUndoRedo,maxUndoLevels:maxUndoLevels,enableHotKeys:enableHotKeys})=>{const intl=(0,react_intl__WEBPACK_IMPORTED_MODULE_8__.c)(),undoLevels=null!=maxUndoLevels?maxUndoLevels:_plone_volto_registry__WEBPACK_IMPORTED_MODULE_4__.default.settings.maxUndoLevels,{doUndo:doUndo,doRedo:doRedo,canUndo:canUndo,canRedo:canRedo}=(0,_plone_volto_helpers_UndoManager_useUndoManager__WEBPACK_IMPORTED_MODULE_3__.c)(state,onUndoRedo,{maxUndoLevels:undoLevels});return __jsx(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,__jsx(_plone_volto_components_manage_Pluggable__WEBPACK_IMPORTED_MODULE_1__.mQ,{pluggable:"main.toolbar.bottom",id:"undo-btn",dependencies:[canUndo,canRedo]},__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_9__.c,{type:"button",className:"undo",onClick:()=>doUndo(),"aria-label":intl.formatMessage(messages.undo),disabled:!canUndo},__jsx(_plone_volto_components_theme_Icon_Icon__WEBPACK_IMPORTED_MODULE_2__.c,{name:_plone_volto_icons_undo_svg__WEBPACK_IMPORTED_MODULE_5___default(),className:"circled",size:"30px",title:intl.formatMessage(messages.undo)}))),__jsx(_plone_volto_components_manage_Pluggable__WEBPACK_IMPORTED_MODULE_1__.mQ,{pluggable:"main.toolbar.bottom",id:"redo-btn",dependencies:[canUndo,canRedo]},__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_9__.c,{type:"button",className:"redo",onClick:()=>doRedo(),"aria-label":intl.formatMessage(messages.redo),disabled:!canRedo},__jsx(_plone_volto_components_theme_Icon_Icon__WEBPACK_IMPORTED_MODULE_2__.c,{name:_plone_volto_icons_redo_svg__WEBPACK_IMPORTED_MODULE_6___default(),className:"circled",size:"30px",title:intl.formatMessage(messages.redo)}))))};__webpack_exports__.default=UndoToolbar,UndoToolbar.__docgenInfo={description:"",methods:[],displayName:"UndoToolbar"}},"./src/helpers/UndoManager/useUndoManager.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),undoo__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../../node_modules/.pnpm/undoo@0.5.0/node_modules/undoo/index.js"),undoo__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(undoo__WEBPACK_IMPORTED_MODULE_1__);__webpack_exports__.c=(state,onUndoRedo,{maxUndoLevels:maxUndoLevels,enableHotKeys:enableHotKeys=!0})=>{const[canUndo,setCanUndo]=react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),[canRedo,setCanRedo]=react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),manager=react__WEBPACK_IMPORTED_MODULE_0__.useRef(new(undoo__WEBPACK_IMPORTED_MODULE_1___default())({maxLength:maxUndoLevels})),callbackRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(onUndoRedo);react__WEBPACK_IMPORTED_MODULE_0__.useEffect((()=>{callbackRef.current=onUndoRedo}),[onUndoRedo]);const doUndo=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((()=>{manager.current.undo((({state:state})=>{const nextUndo=manager.current.canUndo(),nextRedo=manager.current.canRedo();setCanUndo(nextUndo),setCanRedo(nextRedo),callbackRef.current({state:state,type:"undo",canUndo:nextUndo,canRedo:nextRedo})}))}),[]);react__WEBPACK_IMPORTED_MODULE_0__.useEffect((()=>{manager.current.save({state:state}),setCanUndo(manager.current.canUndo()),setCanRedo(manager.current.canRedo())}),[state]);const doRedo=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((()=>{manager.current.redo((({state:state})=>{const nextUndo=manager.current.canUndo(),nextRedo=manager.current.canRedo();setCanUndo(nextUndo),setCanRedo(nextRedo),callbackRef.current({state:state,type:"redo",canUndo:nextUndo,canRedo:nextRedo})}))}),[]),handleKeys=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((event=>{const keyName=event.key;"Control"!==keyName&&"Meta"!==keyName&&(event.ctrlKey||event.metaKey)&&("z"===keyName?(event.preventDefault(),event.stopPropagation(),doUndo()):"y"===keyName&&(event.preventDefault(),event.stopPropagation(),doRedo()))}),[doUndo,doRedo]);return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((()=>{if(enableHotKeys)return document.addEventListener("keydown",handleKeys),()=>document.removeEventListener("keydown",handleKeys)}),[enableHotKeys,handleKeys]),{doUndo:doUndo,doRedo:doRedo,canUndo:canUndo,canRedo:canRedo}}},"./src/icons/copy.svg":function(module){module.exports={attributes:{xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"},content:'<g fill-rule="evenodd"><path d="M14.9997,3.0003 L14.9997,7.0003 L17.0007,7.0003 L17.0007,5.0003 L24.9997,5.0003 L24.9997,11.0003 L30.9997,11.0003 L30.9997,25.0003 L24.9997,25.0003 L24.9997,26.9993 L32.9997,26.9993 L32.9997,9.5853 L26.4147,3.0003 L14.9997,3.0003 Z M27.0007,6.4143 L29.5857,8.9993 L27.0007,8.9993 L27.0007,6.4143 Z"/><path d="M4.9998,8.9997 L4.9998,32.9997 L22.9998,32.9997 L22.9998,15.5857 L16.4148,8.9997 L4.9998,8.9997 Z M6.9998,11.0007 L14.9998,11.0007 L14.9998,16.9997 L20.9998,16.9997 L20.9998,31.0007 L6.9998,31.0007 L6.9998,11.0007 Z M17.0008,12.4147 L19.5858,14.9997 L17.0008,14.9997 L17.0008,12.4147 Z"/></g>'}},"./src/icons/cut.svg":function(module){module.exports={attributes:{xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"},content:'<path fill-rule="evenodd" d="M26,29 C24.346,29 23,27.654 23,26 C23,24.346 24.346,23 26,23 C27.654,23 29,24.346 29,26 C29,27.654 27.654,29 26,29 M10,29 C8.346,29 7,27.654 7,26 C7,24.346 8.346,23 10,23 C11.654,23 13,24.346 13,26 C13,27.654 11.654,29 10,29 M26,21 C24.983,21 24.038,21.309 23.247,21.833 L19.414,18 L29.707,7.707 L28.293,6.293 L18,16.586 L7.707,6.293 L6.293,7.707 L16.586,18 L12.753,21.833 C11.962,21.309 11.017,21 10,21 C7.243,21 5,23.243 5,26 C5,28.757 7.243,31 10,31 C12.757,31 15,28.757 15,26 C15,24.983 14.691,24.038 14.167,23.247 L18,19.414 L21.833,23.247 C21.309,24.038 21,24.983 21,26 C21,28.757 23.243,31 26,31 C28.757,31 31,28.757 31,26 C31,23.243 28.757,21 26,21"/>'}},"./src/icons/drag.svg":function(module){module.exports={attributes:{xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"},content:'<path d="M13 16C11.897 16 11 16.897 11 18 11 19.103 11.897 20 13 20 14.103 20 15 19.103 15 18 15 16.897 14.103 16 13 16M13 22C10.794 22 9 20.206 9 18 9 15.794 10.794 14 13 14 15.206 14 17 15.794 17 18 17 20.206 15.206 22 13 22M23 16C21.897 16 21 16.897 21 18 21 19.103 21.897 20 23 20 24.103 20 25 19.103 25 18 25 16.897 24.103 16 23 16M23 22C20.794 22 19 20.206 19 18 19 15.794 20.794 14 23 14 25.206 14 27 15.794 27 18 27 20.206 25.206 22 23 22M13 26C11.897 26 11 26.897 11 28 11 29.103 11.897 30 13 30 14.103 30 15 29.103 15 28 15 26.897 14.103 26 13 26M13 32C10.794 32 9 30.206 9 28 9 25.794 10.794 24 13 24 15.206 24 17 25.794 17 28 17 30.206 15.206 32 13 32M23 26C21.897 26 21 26.897 21 28 21 29.103 21.897 30 23 30 24.103 30 25 29.103 25 28 25 26.897 24.103 26 23 26M23 32C20.794 32 19 30.206 19 28 19 25.794 20.794 24 23 24 25.206 24 27 25.794 27 28 27 30.206 25.206 32 23 32M13 6C11.897 6 11 6.897 11 8 11 9.103 11.897 10 13 10 14.103 10 15 9.103 15 8 15 6.897 14.103 6 13 6M13 12C10.794 12 9 10.206 9 8 9 5.794 10.794 4 13 4 15.206 4 17 5.794 17 8 17 10.206 15.206 12 13 12M23 6C21.897 6 21 6.897 21 8 21 9.103 21.897 10 23 10 24.103 10 25 9.103 25 8 25 6.897 24.103 6 23 6M23 12C20.794 12 19 10.206 19 8 19 5.794 20.794 4 23 4 25.206 4 27 5.794 27 8 27 10.206 25.206 12 23 12" fill-rule="evenodd"/>'}},"./src/icons/paste.svg":function(module){module.exports={attributes:{xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"},content:'<g fill-rule="evenodd"><path d="M25 7 25 9 27.001 9 27.001 31 9.001 31 9.001 9 11.001 9 11.001 7 7 7 7 33 29.001 33 29.001 7z"/><path d="M21,9 L15,9 L15,7 L17,7 L17,6 C17,5.448 17.448,5 18,5 C18.552,5 19,5.448 19,6 L19,7 L21,7 L21,9 Z M23,5 L20.829,5 C20.416,3.836 19.304,3 18,3 C16.696,3 15.584,3.836 15.171,5 L13,5 L13,11 L23,11 L23,5 Z"/></g>'}},"./src/icons/redo.svg":function(module){module.exports={attributes:{xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"},content:'<path fill-rule="evenodd" d="M23.7192,4.3052 L22.2812,5.6952 L25.4722,9.0002 L17.0002,9.0002 C11.4862,9.0002 7.0002,13.4862 7.0002,19.0002 C7.0002,24.5142 11.4862,29.0002 17.0002,29.0002 L18.0002,29.0002 L18.0002,27.0002 L17.0002,27.0002 C12.5892,27.0002 9.0002,23.4112 9.0002,19.0002 C9.0002,14.5892 12.5892,11.0002 17.0002,11.0002 L25.4722,11.0002 L22.2812,14.3052 L23.7192,15.6952 L29.2192,10.0002 L23.7192,4.3052 Z"/>'}},"./src/icons/undo.svg":function(module){module.exports={attributes:{xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"},content:'<path fill-rule="evenodd" d="M19,9 L10.527,9 L13.719,5.695 L12.281,4.305 L6.781,10 L12.281,15.695 L13.719,14.305 L10.527,11 L19,11 C23.411,11 27,14.589 27,19 C27,23.411 23.411,27 19,27 L18,27 L18,29 L19,29 C24.514,29 29,24.514 29,19 C29,13.486 24.514,9 19,9"/>'}}}]);